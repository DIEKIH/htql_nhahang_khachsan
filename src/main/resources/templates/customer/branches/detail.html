<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title th:text="${branch.name} + ' - Chi tiết'">Chi tiết chi nhánh</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" th:href="@{/css/user_navbar.css}">
    <style>
        :root {
            --primary-color: #c9a96e;
            --secondary-color: #2c3e50;
            --accent-color: #f8f9fa;
            --text-dark: #2c3e50;
            --text-light: #6c757d;
            --bg-overlay: rgba(44, 62, 80, 0.7);
            --success-color: #28a745;
            --warning-color: #ffc107;
            --danger-color: #dc3545;
            --branch-bg: url('https://example.com/default.jpg');
            --scale: 0.75;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: calc(16px * var(--scale));
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            padding-top: calc(80px * var(--scale));
        }

        .input-group .btn {
            border: 2px solid #e9ecef;
        }

        .input-group .form-control {
            font-size: calc(1.1rem * var(--scale));
            font-weight: 600;
        }

        .suggestion-card {
            background: white;
            border: 2px solid var(--primary-color);
            border-radius: calc(12px * var(--scale));
            padding: calc(15px * var(--scale));
            margin-bottom: calc(10px * var(--scale));
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-card:hover {
            transform: translateY(calc(-3px * var(--scale)));
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .suggestion-card.selected {
            background: var(--primary-color);
            color: white;
        }

        .table-badge {
            display: inline-block;
            background: #e9ecef;
            padding: calc(5px * var(--scale)) calc(12px * var(--scale));
            border-radius: calc(20px * var(--scale));
            margin: calc(3px * var(--scale));
            font-size: calc(0.85rem * var(--scale));
        }

        .suggestion-card.selected .table-badge {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        .heading-font {
            font-family: 'Playfair Display', serif;
        }

        /* Navigation */
        .navbar {
            background: rgba(255, 255, 255, 0.98) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            height: calc(80px * var(--scale));
        }

        .navbar-brand {
            font-family: 'Playfair Display', serif;
            font-size: calc(2rem * var(--scale));
            font-weight: 600;
            color: var(--primary-color) !important;
        }

        .navbar-nav .nav-link {
            font-weight: 500;
            margin: 0 calc(10px * var(--scale));
            color: var(--text-dark) !important;
            transition: all 0.3s ease;
        }

        .navbar-nav .nav-link:hover,
        .navbar-nav .nav-link.active {
            color: var(--primary-color) !important;
        }

        .btn-luxury {
            background: var(--primary-color);
            color: white;
            padding: calc(12px * var(--scale)) calc(30px * var(--scale));
            border: none;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            border-radius: calc(50px * var(--scale));
        }

        .btn-luxury:hover {
            background: #b8956b;
            transform: translateY(calc(-3px * var(--scale)));
            box-shadow: 0 10px 25px rgba(201, 169, 110, 0.4);
            color: white;
        }

        /* Page Header */
        .page-header {
            background: linear-gradient(var(--bg-overlay), var(--bg-overlay)),
            var(--branch-bg, url('https://images.unsplash.com/photo-1566073771259-6a8506099945?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80')) center/cover;
            padding: calc(80px * var(--scale)) 0 calc(60px * var(--scale));
            color: white;
            text-align: center;
        }

        .breadcrumb {
            background: none;
            padding: 0;
        }

        .breadcrumb-item a {
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
        }

        .breadcrumb-item.active {
            color: var(--primary-color);
        }

        /* Branch Info */
        .branch-info {
            background: rgba(255,255,255,0.95);
            backdrop-filter: blur(10px);
            border-radius: calc(20px * var(--scale));
            padding: calc(30px * var(--scale));
            margin-top: calc(-50px * var(--scale));
            position: relative;
            z-index: 10;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .branch-badges {
            display: flex;
            flex-wrap: wrap;
            gap: calc(10px * var(--scale));
            margin: calc(20px * var(--scale)) 0;
        }

        .promotion-banner {
            background: linear-gradient(45deg, #ff6b6b, #ff8e53);
            color: white;
            padding: calc(15px * var(--scale));
            border-radius: calc(15px * var(--scale));
            margin: calc(20px * var(--scale)) 0;
            position: relative;
            overflow: hidden;
        }

        /* Service Tabs */
        .service-nav {
            background: white;
            padding: calc(30px * var(--scale)) 0;
            box-shadow: 0 2px 15px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: calc(80px * var(--scale));
            z-index: 999;
        }

        .nav-pills .nav-link {
            background: transparent;
            color: var(--text-dark);
            border: 2px solid #e9ecef;
            border-radius: calc(50px * var(--scale));
            padding: calc(15px * var(--scale)) calc(30px * var(--scale));
            font-weight: 600;
            margin: 0 calc(10px * var(--scale));
            transition: all 0.3s ease;
        }

        .nav-pills .nav-link:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
        }

        .nav-pills .nav-link.active {
            background: var(--primary-color);
            border-color: var(--primary-color);
            color: white;
        }

        /* Filter Section */
        .filter-section {
            background: #f8f9fa;
            padding: calc(20px * var(--scale));
            border-radius: calc(15px * var(--scale));
            margin-bottom: calc(30px * var(--scale));
        }

        .filter-widget {
            background: white;
            border-radius: calc(15px * var(--scale));
            padding: calc(25px * var(--scale));
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.05);
            margin-bottom: calc(20px * var(--scale));
        }

        .filter-widget h6 {
            color: var(--text-dark);
            margin-bottom: calc(15px * var(--scale));
            padding-bottom: calc(10px * var(--scale));
            border-bottom: 2px solid var(--primary-color);
            font-weight: 600;
        }

        /* Service Cards */
        .service-card {
            background: white;
            border-radius: calc(20px * var(--scale));
            overflow: hidden;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.08);
            transition: all 0.4s ease;
            margin-bottom: calc(30px * var(--scale));
            height: 100%;
        }

        .service-card:hover {
            transform: translateY(calc(-10px * var(--scale)));
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.15);
        }

        .service-image {
            height: calc(250px * var(--scale));
            position: relative;
            overflow: hidden;
        }

        .service-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.5s ease;
        }

        .service-card:hover .service-image img {
            transform: scale(1.1);
        }

        .price-badge {
            position: absolute;
            top: calc(15px * var(--scale));
            right: calc(15px * var(--scale));
            background: var(--primary-color);
            color: white;
            padding: calc(8px * var(--scale)) calc(15px * var(--scale));
            border-radius: calc(20px * var(--scale));
            font-weight: 600;
            font-size: calc(0.9rem * var(--scale));
        }

        .branch-badge {
            position: absolute;
            top: calc(15px * var(--scale));
            left: calc(15px * var(--scale));
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: calc(5px * var(--scale)) calc(12px * var(--scale));
            border-radius: calc(15px * var(--scale));
            font-size: calc(0.8rem * var(--scale));
        }

        .service-content {
            padding: calc(25px * var(--scale));
        }

        .service-title {
            color: var(--text-dark);
            margin-bottom: calc(10px * var(--scale));
            font-size: calc(1.25rem * var(--scale));
        }

        .service-description {
            color: var(--text-light);
            font-size: calc(0.9rem * var(--scale));
            margin-bottom: calc(15px * var(--scale));
        }

        .amenities-tags {
            display: flex;
            flex-wrap: wrap;
            gap: calc(8px * var(--scale));
            margin-bottom: calc(20px * var(--scale));
        }

        .amenity-tag {
            background: #f0f0f0;
            color: var(--text-dark);
            padding: calc(5px * var(--scale)) calc(12px * var(--scale));
            border-radius: calc(15px * var(--scale));
            font-size: calc(0.8rem * var(--scale));
            border: 1px solid #e9ecef;
        }

        .service-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            border-top: 1px solid #eee;
            padding-top: calc(15px * var(--scale));
        }

        .rating {
            color: #ffc107;
        }

        /* Room Status */
        .room-status {
            padding: calc(4px * var(--scale)) calc(8px * var(--scale));
            border-radius: calc(12px * var(--scale));
            font-size: calc(0.8rem * var(--scale));
            font-weight: 600;
        }

        .status-available { background: #d4edda; color: #155724; }
        .status-occupied { background: #f8d7da; color: #721c24; }
        .status-maintenance { background: #fff3cd; color: #856404; }
        .status-cleaning { background: #cce5ff; color: #004085; }

        /*!* Restaurant Tables *!*/
        /*.table-layout {*/
        /*    background: #f8f9fa;*/
        /*    padding: calc(30px * var(--scale));*/
        /*    border-radius: calc(15px * var(--scale));*/
        /*    margin: calc(20px * var(--scale)) 0;*/
        /*}*/

        /*.table-item {*/
        /*    background: white;*/
        /*    border: 2px solid #e9ecef;*/
        /*    border-radius: 50%;*/
        /*    width: calc(60px * var(--scale));*/
        /*    height: calc(60px * var(--scale));*/
        /*    display: flex;*/
        /*    align-items: center;*/
        /*    justify-content: center;*/
        /*    margin: calc(10px * var(--scale));*/
        /*    cursor: pointer;*/
        /*    transition: all 0.3s ease;*/
        /*    font-weight: 600;*/
        /*}*/

        /*.table-available { border-color: var(--success-color); color: var(--success-color); }*/
        /*.table-occupied { border-color: var(--danger-color); color: var(--danger-color); }*/
        /*.table-reserved { border-color: var(--warning-color); color: var(--warning-color); }*/

        /*.table-item:hover {*/
        /*    transform: scale(1.1);*/
        /*    box-shadow: 0 5px 15px rgba(0,0,0,0.2);*/
        /*}*/

        /* Mobile Filter Button */
        .mobile-filter-btn {
            display: none;
        }

        /* Loading States */
        .loading {
            text-align: center;
            padding: calc(40px * var(--scale));
        }

        .spinner {
            width: calc(40px * var(--scale));
            height: calc(40px * var(--scale));
            border: calc(4px * var(--scale)) solid #f3f3f3;
            border-top: calc(4px * var(--scale)) solid var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }


        /*css mới của nhà hàng*/

        /* ==================== Category Filter Section ==================== */
        .category-filter-section {
            background: white;
            padding: 25px;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
            margin-bottom: 30px;
        }

        .sort-select {
            width: auto;
            max-width: 250px;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 10px 15px;
            font-weight: 600;
            color: var(--text-dark);
        }

        .category-pills-wrapper {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
            margin-top: 20px;
        }

        .category-pill-btn {
            display: inline-flex;
            align-items: center;
            padding: 12px 24px;
            border: 2px solid #e9ecef;
            border-radius: 50px;
            background: white;
            color: var(--text-dark);
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 0.95rem;
        }

        .category-pill-btn:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            transform: translateY(-2px);
            box-shadow: 0 4px 12px rgba(201, 169, 110, 0.2);
        }

        .category-pill-btn.active {
            background: linear-gradient(135deg, var(--primary-color), #d4b079);
            border-color: var(--primary-color);
            color: white;
            box-shadow: 0 4px 15px rgba(201, 169, 110, 0.3);
        }

        .pill-badge {
            background: rgba(0,0,0,0.1);
            padding: 3px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            margin-left: 8px;
            font-weight: 700;
        }

        .category-pill-btn.active .pill-badge {
            background: rgba(255,255,255,0.3);
        }

        /* ==================== Menu Items Grid ==================== */
        .menu-items-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }

        .menu-item-card {
            animation: fadeInUp 0.6s ease-out backwards;
        }

        .menu-item-card:nth-child(1) { animation-delay: 0.05s; }
        .menu-item-card:nth-child(2) { animation-delay: 0.1s; }
        .menu-item-card:nth-child(3) { animation-delay: 0.15s; }
        .menu-item-card:nth-child(4) { animation-delay: 0.2s; }
        .menu-item-card:nth-child(5) { animation-delay: 0.25s; }
        .menu-item-card:nth-child(6) { animation-delay: 0.3s; }

        .menu-card-inner {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            box-shadow: 0 8px 25px rgba(0,0,0,0.08);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .menu-card-inner:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.15);
        }

        /* ==================== Menu Card Image ==================== */
        .menu-card-image {
            height: 240px;
            position: relative;
            overflow: hidden;
        }

        .menu-card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            transition: transform 0.6s ease;
        }

        .menu-card-inner:hover .menu-card-image img {
            transform: scale(1.1);
        }

        .image-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(to bottom, transparent 0%, rgba(0,0,0,0.3) 100%);
        }

        .category-badge-overlay {
            position: absolute;
            top: 15px;
            left: 15px;
            background: rgba(0,0,0,0.75);
            backdrop-filter: blur(10px);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
        }

        .price-badge-overlay {
            position: absolute;
            top: 15px;
            right: 15px;
            background: var(--primary-color);
            color: white;
            padding: 8px 16px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1rem;
            box-shadow: 0 4px 15px rgba(201, 169, 110, 0.4);
            z-index: 2;
        }

        .old-price-overlay {
            text-decoration: line-through;
            opacity: 0.7;
            font-size: 0.85rem;
            margin-right: 5px;
        }

        .status-badge-overlay {
            position: absolute;
            bottom: 15px;
            left: 15px;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.8rem;
            font-weight: 600;
            z-index: 2;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .status-available {
            background: rgba(40, 167, 69, 0.9);
            color: white;
        }

        .status-unavailable {
            background: rgba(220, 53, 69, 0.9);
            color: white;
        }

        /* ==================== Menu Card Content ==================== */
        .menu-card-content {
            padding: 25px;
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .menu-item-title {
            font-size: 1.35rem;
            font-weight: 700;
            color: var(--text-dark);
            margin-bottom: 12px;
            line-height: 1.3;
        }

        .menu-item-description {
            color: var(--text-light);
            font-size: 0.95rem;
            line-height: 1.6;
            margin-bottom: 18px;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .menu-item-meta {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 20px;
        }

        .meta-item {
            display: inline-flex;
            align-items: center;
            gap: 6px;
            background: #f8f9fa;
            padding: 6px 12px;
            border-radius: 20px;
            font-size: 0.85rem;
            color: var(--text-dark);
            border: 1px solid #e9ecef;
        }

        .meta-item i {
            font-size: 0.9rem;
            color: var(--primary-color);
        }

        /* ==================== Menu Card Actions ==================== */
        .menu-card-actions {
            margin-top: auto;
            padding-top: 18px;
            border-top: 2px solid #f0f0f0;
        }

        .rating-display {
            display: flex;
            align-items: center;
            gap: 3px;
            color: #ffc107;
            font-size: 0.9rem;
            margin-bottom: 15px;
        }

        .rating-count {
            color: var(--text-light);
            font-size: 0.85rem;
            margin-left: 6px;
        }

        .action-buttons-group {
            display: flex;
            gap: 8px;
        }

        .btn-action {
            flex: 1;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: 6px;
            padding: 10px 16px;
            border-radius: 25px;
            font-weight: 600;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            cursor: pointer;
            border: none;
            text-decoration: none;
        }

        .btn-view-detail {
            border: 2px solid var(--primary-color);
            background: white;
            color: var(--primary-color);
        }

        .btn-view-detail:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
        }

        .btn-order-now {
            background: linear-gradient(135deg, var(--primary-color), #d4b079);
            color: white;
            box-shadow: 0 4px 15px rgba(201, 169, 110, 0.3);
        }

        .btn-order-now:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(201, 169, 110, 0.4);
        }

        .btn-order-now:disabled {
            background: #6c757d;
            cursor: not-allowed;
            opacity: 0.6;
        }

        /* ==================== Empty State ==================== */
        .empty-state-section {
            text-align: center;
            padding: 80px 20px;
            background: white;
            border-radius: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.05);
        }

        .empty-state-content i {
            font-size: 4rem;
            color: var(--text-light);
            margin-bottom: 20px;
        }

        .empty-state-content h5 {
            color: var(--text-dark);
            font-weight: 600;
            margin-bottom: 10px;
        }

        .empty-state-content p {
            color: var(--text-light);
        }

        /* ==================== Booking Form Section ==================== */
        .booking-form-section {
            margin-top: 60px;
            padding: 0 15px;
        }

        .booking-form-container {
            max-width: 700px;
            margin: 0 auto;
            background: white;
            border-radius: 25px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .booking-form-header-section {
            background: linear-gradient(135deg, var(--primary-color), #d4b079);
            color: white;
            padding: 25px 30px;
            text-align: center;
        }

        .header-icon {
            font-size: 3rem;
            margin-bottom: 15px;
        }

        .booking-form-header-section h3 {
            font-size: 2rem;
            margin-bottom: 10px;
            font-weight: 700;
        }

        .header-subtitle {
            font-size: 1.1rem;
            opacity: 0.95;
            margin: 0;
        }

        .booking-form {
            padding: 25px 30px;
        }

        /* ==================== Form Sections ==================== */
        .form-section {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 15px;
            margin-bottom: 15px;
        }

        .section-header-title {
            display: flex;
            align-items: center;
            gap: 10px;
            color: var(--text-dark);
            font-weight: 700;
            font-size: 1rem;
            margin-bottom: 18px;
            padding-bottom: 10px;
            border-bottom: 2px solid var(--primary-color);
        }

        .section-header-title i {
            font-size: 1.1rem;
            color: var(--primary-color);
        }

        /* ==================== Form Controls ==================== */
        .form-label-custom {
            font-weight: 600;
            color: var(--text-dark);
            margin-bottom: 8px;
            font-size: 0.9rem;
            display: block;
        }

        .required-star {
            color: #dc3545;
            font-weight: 700;
        }

        .input-with-icon {
            position: relative;
        }

        .input-with-icon i {
            position: absolute;
            left: 15px;
            top: 50%;
            transform: translateY(-50%);
            color: var(--primary-color);
            font-size: 0.95rem;
            z-index: 1;
        }

        .input-with-icon.textarea-wrapper i {
            top: 18px;
            transform: none;
        }

        .form-control-custom {
            width: 100%;
            padding: 10px 15px 10px 42px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 0.95rem;
            transition: all 0.3s ease;
            color: var(--text-dark);
        }

        .form-control-custom:focus {
            border-color: var(--primary-color);
            box-shadow: 0 0 0 0.2rem rgba(201, 169, 110, 0.15);
            outline: none;
        }

        .textarea-custom {
            resize: vertical;
            min-height: 100px;
            padding-left: 42px !important;
        }

        .form-hint {
            display: block;
            margin-top: 6px;
            font-size: 0.8rem;
            color: var(--text-light);
        }

        .form-hint i {
            margin-right: 5px;
        }

        /* ==================== Party Size Input ==================== */
        .party-size-input {
            display: flex;
            align-items: center;
            gap: 0;
            max-width: 250px;
        }

        .party-btn {
            width: 45px;
            height: 45px;
            border: 2px solid #e9ecef;
            background: white;
            color: var(--primary-color);
            font-size: 1.1rem;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .party-btn-minus {
            border-radius: 10px 0 0 10px;
            border-right: none;
        }

        .party-btn-plus {
            border-radius: 0 10px 10px 0;
            border-left: none;
        }

        .party-btn:hover {
            background: var(--primary-color);
            color: white;
        }

        .party-input {
            flex: 1;
            text-align: center;
            font-size: 1.3rem !important;
            font-weight: 700;
            border-left: none !important;
            border-right: none !important;
            padding-left: 15px !important;
        }

        /* ==================== Table Suggestions ==================== */
        .table-suggestion-loading {
            margin-top: 20px;
            padding: 15px;
            background: #e7f3ff;
            border-radius: 12px;
            border: 2px solid #b3d9ff;
        }

        .loading-content {
            display: flex;
            align-items: center;
            gap: 12px;
            justify-content: center;
            color: #0066cc;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .table-suggestions {
            margin-top: 20px;
        }

        .suggestion-success-alert {
            background: #d4edda;
            border: 2px solid #c3e6cb;
            color: #155724;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .suggestion-success-alert i {
            font-size: 1.2rem;
        }

        .suggestion-error-alert {
            background: #f8d7da;
            border: 2px solid #f5c6cb;
            color: #721c24;
            padding: 15px;
            border-radius: 12px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-weight: 600;
            font-size: 0.9rem;
        }

        .suggestion-error-alert i {
            font-size: 1.2rem;
        }

        .suggestions-title {
            font-weight: 600;
            font-size: 0.95rem;
            margin-bottom: 12px;
            color: var(--text-dark);
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .suggestion-card {
            background: white;
            border: 2px solid #e9ecef;
            border-radius: 12px;
            padding: 15px;
            margin-bottom: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .suggestion-card:hover {
            border-color: var(--primary-color);
            transform: translateX(3px);
            box-shadow: 0 4px 15px rgba(201, 169, 110, 0.2);
        }

        .suggestion-card.selected {
            background: linear-gradient(135deg, var(--primary-color), #d4b079);
            border-color: var(--primary-color);
            color: white;
        }

        .suggestion-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 12px;
        }

        .suggestion-description {
            font-size: 1rem;
            font-weight: 700;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .suggestion-capacity {
            background: var(--primary-color);
            color: white;
            padding: 6px 14px;
            border-radius: 20px;
            font-weight: 700;
            font-size: 0.9rem;
            display: flex;
            align-items: center;
            gap: 6px;
        }

        .suggestion-card.selected .suggestion-capacity {
            background: rgba(255,255,255,0.3);
        }

        .suggestion-tables {
            margin-top: 12px;
            display: flex;
            flex-wrap: wrap;
            gap: 6px;
        }

        .table-badge {
            display: inline-block;
            background: #f0f0f0;
            padding: 6px 12px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: 600;
            color: var(--text-dark);
        }

        .suggestion-card.selected .table-badge {
            background: rgba(255,255,255,0.25);
            color: white;
        }

        /* ==================== Important Notes ==================== */
        .important-notes {
            background: #fff3cd;
            border: 2px solid #ffc107;
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 20px;
        }

        .notes-header {
            display: flex;
            align-items: center;
            gap: 12px;
            font-weight: 700;
            font-size: 1.15rem;
            color: #856404;
            margin-bottom: 20px;
        }

        .notes-header i {
            font-size: 1.5rem;
        }

        .notes-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .notes-list li {
            display: flex;
            align-items: flex-start;
            gap: 12px;
            color: #856404;
            margin-bottom: 12px;
            font-size: 0.95rem;
        }

        .notes-list li:last-child {
            margin-bottom: 0;
        }

        .notes-list li i {
            color: #ffc107;
            margin-top: 3px;
            flex-shrink: 0;
        }

        /* ==================== Form Actions ==================== */
        .form-actions {
            display: flex;
            gap: 15px;
            justify-content: center;
            flex-wrap: wrap;
        }

        .btn-form-action {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            padding: 12px 30px;
            border-radius: 50px;
            font-weight: 700;
            font-size: 1.05rem;
            text-transform: uppercase;
            letter-spacing: 0.5px;
            cursor: pointer;
            transition: all 0.3s ease;
            border: none;
        }

        .btn-reset-form {
            background: white;
            color: var(--text-dark);
            border: 2px solid #e9ecef;
        }

        .btn-reset-form:hover {
            border-color: var(--primary-color);
            color: var(--primary-color);
            transform: translateY(-2px);
        }

        .btn-submit-form {
            background: linear-gradient(135deg, var(--primary-color), #d4b079);
            color: white;
            box-shadow: 0 6px 25px rgba(201, 169, 110, 0.3);
        }

        .btn-submit-form:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 35px rgba(201, 169, 110, 0.4);
        }

        /* ==================== Animations ==================== */
        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* ==================== Responsive ==================== */
        @media (max-width: 991px) {
            .menu-items-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 20px;
            }
        }

        @media (max-width: 768px) {
            .category-filter-section {
                padding: 20px;
            }

            .sort-select {
                max-width: 100%;
                margin-top: 10px;
            }

            .menu-items-grid {
                grid-template-columns: 1fr;
            }

            .menu-card-image {
                height: 200px;
            }

            .action-buttons-group {
                flex-direction: column;
            }

            .btn-action {
                width: 100%;
            }

            .booking-form {
                padding: 30px 20px;
            }

            .form-section {
                padding: 20px;
            }

            .party-size-input {
                max-width: 100%;
            }

            .form-actions {
                flex-direction: column;
            }

            .btn-form-action {
                width: 100%;
                justify-content: center;
            }
        }

        @media (max-width: 576px) {
            .booking-form-header-section {
                padding: 30px 20px;
            }

            .booking-form-header-section h3 {
                font-size: 1.5rem;
            }

            .header-icon {
                font-size: 2.5rem;
            }

            .menu-item-title {
                font-size: 1.15rem;
            }

            .menu-card-content {
                padding: 20px;
            }

            .category-pill-btn {
                padding: 10px 18px;
                font-size: 0.85rem;
            }
        }
        /*end*/
        /* Responsive */
        @media (max-width: 991px) {
            .mobile-filter-btn {
                display: block;
                margin-bottom: calc(20px * var(--scale));
            }

            .desktop-filter {
                display: none;
            }

            .nav-pills .nav-link {
                margin: calc(5px * var(--scale));
                padding: calc(12px * var(--scale)) calc(20px * var(--scale));
                font-size: calc(0.9rem * var(--scale));
            }

            .service-content {
                padding: calc(20px * var(--scale));
            }

            .service-actions {
                flex-direction: column;
                gap: calc(15px * var(--scale));
            }
        }

        @media (max-width: 576px) {
            :root {
                --scale: 0.65;
            }

            .navbar-brand {
                font-size: calc(1.5rem * var(--scale));
            }

            .page-header {
                padding: calc(60px * var(--scale)) 0 calc(40px * var(--scale));
            }

            .nav-pills {
                flex-direction: column;
            }

            .nav-pills .nav-link {
                margin: calc(5px * var(--scale)) 0;
                text-align: center;
            }
        }

        /* Loading Animation */
        .loading-skeleton {
            background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);
            background-size: 200% 100%;
            animation: loading 1.5s infinite;
        }

        @keyframes loading {
            0% { background-position: 200% 0; }
            100% { background-position: -200% 0; }
        }

        @keyframes fadeInUp {
            from { opacity: 0; transform: translateY(calc(20px * var(--scale))); }
            to { opacity: 1; transform: translateY(0); }
        }

        @keyframes fadeOutDown {
            from { opacity: 1; transform: translateY(0); }
            to { opacity: 0; transform: translateY(calc(-20px * var(--scale))); }
        }
    </style>
</head>

<body>
<!-- Navigation -->
<div th:replace="fragments/user_navbar :: user_navbar"></div>
<!--<nav th:fragment="user_navbar" class="navbar navbar-expand-lg fixed-top">-->
<!--    <div class="container">-->
<!--        <a class="navbar-brand" th:href="@{/}"><i class="fas fa-crown me-2"></i>DIEK</a>-->
<!--        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">-->
<!--            <span class="navbar-toggler-icon"></span>-->
<!--        </button>-->
<!--        <div class="collapse navbar-collapse" id="navbarNav">-->
<!--            <ul class="navbar-nav ms-auto" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">-->
<!--                <li class="nav-item"><a class="nav-link" th:href="@{/}">Trang chủ</a></li>-->
<!--                <li class="nav-item"><a class="nav-link" th:href="@{/#branches}">Chi nhánh</a></li>-->
<!--                <li class="nav-item"><a class="nav-link" href="#facilities">Tiện ích</a></li>-->
<!--                <li class="nav-item"><a class="nav-link" href="#contact">Liên hệ</a></li>-->

<!--                &lt;!&ndash; Login button for anonymous users &ndash;&gt;-->
<!--                <li class="nav-item" sec:authorize="isAnonymous()">-->
<!--                    <a class="nav-link btn btn-outline-primary ms-2" th:href="@{/customer/login}">-->
<!--                        <i class="fas fa-sign-in-alt me-2"></i>Đăng nhập-->
<!--                    </a>-->
<!--                </li>-->

<!--                &lt;!&ndash; User dropdown for authenticated users &ndash;&gt;-->
<!--                <li class="nav-item dropdown" sec:authorize="isAuthenticated()">-->
<!--                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">-->
<!--                        <i class="fas fa-user-circle me-1"></i>-->
<!--                        <span sec:authentication="name">Username</span>-->
<!--                    </a>-->
<!--                    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="navbarDropdown">-->
<!--                        <li>-->
<!--                            <a class="dropdown-item" th:href="@{/cart}">-->
<!--                                <i class="fas fa-shopping-cart fa-fw me-2"></i>Giỏ hàng-->
<!--                                <span class="badge bg-danger rounded-pill" th:if="${session.cartItemCount > 0}" th:text="${session.cartItemCount}">0</span>-->
<!--                            </a>-->
<!--                        </li>-->
<!--                        <li><a class="dropdown-item" th:href="@{/orders}"><i class="fas fa-receipt fa-fw me-2"></i>Xem đơn hàng</a></li>-->
<!--                        <li><hr class="dropdown-divider"></li>-->
<!--                        <li>-->
<!--                            <form th:action="@{/logout}" method="post" class="d-inline">-->
<!--                                <button type="submit" class="dropdown-item">-->
<!--                                    <i class="fas fa-sign-out-alt fa-fw me-2"></i>Đăng xuất-->
<!--                                </button>-->
<!--                            </form>-->
<!--                        </li>-->
<!--                    </ul>-->
<!--                </li>-->
<!--            </ul>-->
<!--        </div>-->
<!--    </div>-->
<!--</nav>-->

<!-- Page Header -->
<section class="page-header" th:style="'--branch-bg: url(' + ${branch.defaultImage} + ')'">
    <div class="container">
        <nav aria-label="breadcrumb">
            <ol class="breadcrumb justify-content-center mb-4">
                <li class="breadcrumb-item"><a href="/">Trang chủ</a></li>
                <li class="breadcrumb-item"><a href="/#branches">Chi nhánh</a></li>
                <li class="breadcrumb-item active" th:text="${branch.name}">Chi nhánh</li>
            </ol>
        </nav>
        <h1 class="heading-font display-4 mb-3" th:text="${branch.name}">Tên chi nhánh</h1>
        <p class="lead">
            <i class="fas fa-map-marker-alt me-2"></i>
            <span th:text="${branch.fullAddress}">Địa chỉ đầy đủ</span>
        </p>
    </div>
</section>

<!-- Branch Info -->
<section class="py-0">
    <div class="container">
        <div class="branch-info">
            <div class="row align-items-center">
                <div class="col-md-8">
                    <div class="branch-badges" th:utext="${#strings.listJoin(branch.serviceBadges, '')}">
                        <!-- Service badges will be rendered here -->
                    </div>
                    <p class="text-muted mb-3" th:text="${branch.description}">Mô tả chi nhánh</p>
                    <div class="row g-3">
                        <div class="col-auto">
                            <strong><i class="fas fa-phone text-primary me-2"></i>Điện thoại:</strong>
                            <span th:text="${branch.phoneNumber}">Phone</span>
                        </div>
                        <div class="col-auto">
                            <strong><i class="fas fa-envelope text-primary me-2"></i>Email:</strong>
                            <span th:text="${branch.email}">Email</span>
                        </div>
                    </div>
                </div>
                <div class="col-md-4 text-center">
                    <div class="badge bg-success fs-6 px-3 py-2">
                        <i class="fas fa-check-circle me-2"></i>
                        <span th:text="${branch.statusDisplayName}">Trạng thái</span>
                    </div>
                    <div class="mt-3">
                        <div class="text-warning">
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <i class="fas fa-star"></i>
                            <span class="text-muted ms-2">(4.8/5)</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>



<!-- Service Navigation Tabs -->
<section class="service-nav">
    <div class="container">
        <ul class="nav nav-pills justify-content-center" id="service-tabs" role="tablist">
            <!-- Hotel tab -->
            <li class="nav-item" role="presentation"
                th:if="${branch.type.name() == 'HOTEL' or branch.type.name() == 'BOTH'}">
                <button class="nav-link active" id="rooms-tab" data-bs-toggle="pill"
                        data-bs-target="#rooms" type="button" role="tab">
                    <i class="fas fa-bed me-2"></i>Phòng khách sạn
                </button>
            </li>

            <!-- Restaurant tab -->
            <li class="nav-item" role="presentation"
                th:if="${branch.type.name() == 'RESTAURANT' or branch.type.name() == 'BOTH'}">
                <button class="nav-link" id="restaurant-tab" data-bs-toggle="pill"
                        data-bs-target="#restaurant" type="button" role="tab"
                        th:classappend="${branch.type.name() == 'RESTAURANT'} ? 'active' : ''">
                    <i class="fas fa-utensils me-2"></i>Ẩm thực & Nhà hàng
                </button>
            </li>
        </ul>
    </div>
</section>

<!-- Main Content -->
<section class="py-5">
    <div class="container">
        <div class="tab-content" id="service-content">
            <!-- Rooms Tab -->
            <div class="tab-pane fade show active" id="rooms" role="tabpanel"
                 th:if="${branch.type.name() == 'HOTEL' or branch.type.name() == 'BOTH'}">
                <div class="row">
                    <!-- Mobile Filter Button -->
                    <div class="col-12">
                        <button class="btn btn-outline-primary mobile-filter-btn w-100" type="button"
                                data-bs-toggle="offcanvas" data-bs-target="#roomFilters">
                            <i class="fas fa-filter me-2"></i>Bộ lọc
                        </button>
                    </div>

                    <!-- Desktop Sidebar Filter -->
                    <div class="col-lg-3 desktop-filter">
                        <div class="filter-section">
                            <h5 class="heading-font mb-4">
                                <i class="fas fa-filter me-2"></i>Bộ lọc phòng
                            </h5>

                            <div class="filter-widget">
                                <h6>Loại phòng</h6>
                                <select class="form-select" id="roomTypeFilter">
                                    <option value="">Tất cả loại phòng</option>
                                    <option th:each="roomType : ${roomTypes}"
                                            th:value="${roomType.id}"
                                            th:text="${roomType.name}">Room Type</option>
                                </select>
                            </div>

                            <div class="filter-widget">
                                <h6>Khoảng giá (VNĐ/đêm)</h6>
                                <input type="range" class="form-range" min="500000" max="5000000"
                                       step="100000" value="2000000" id="roomPriceRange">
                                <div class="d-flex justify-content-between">
                                    <span>500K</span>
                                    <span id="roomPriceValue">2.000K</span>
                                    <span>5.000K</span>
                                </div>
                            </div>

                            <div class="filter-widget">
                                <h6>Trạng thái phòng</h6>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="available">
                                    <label class="form-check-label" for="available">Có thể thuê</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="occupied">
                                    <label class="form-check-label" for="occupied">Đang thuê</label>
                                </div>
                                <div class="form-check">
                                    <input class="form-check-input" type="checkbox" id="cleaning">
                                    <label class="form-check-label" for="cleaning">Đang dọn dẹp</label>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Rooms Content -->
                    <div class="col-lg-9">
                        <!-- Room Types Section -->
                        <div class="d-flex justify-content-between align-items-center mb-4">
                            <h4>Tìm thấy <span id="roomCount" th:text="${#lists.size(roomTypes)}">0</span> loại phòng</h4>
                            <select class="form-select" style="width: auto;" id="roomSort">
                                <option>Sắp xếp: Phù hợp nhất</option>
                                <option>Giá thấp đến cao</option>
                                <option>Giá cao đến thấp</option>
                                <option>Đánh giá cao nhất</option>
                            </select>
                        </div>

                        <div class="row" id="roomsGrid">
                            <!-- Room Type Cards -->
                            <div class="col-lg-4 col-md-6 room-type-card" th:each="roomType : ${roomTypes}">
                                <div class="service-card">
                                    <div class="service-image">
                                        <div th:if="${roomType.hasImages()}"
                                             class="carousel slide" th:id="'carousel-' + ${roomType.id}"
                                             data-bs-ride="carousel">
                                            <div class="carousel-inner">
                                                <div class="carousel-item"
                                                     th:each="image : ${roomType.roomImages}"
                                                     th:classappend="${imageStat.first} ? 'active' : ''">
                                                    <img th:src="${image.imageUrl}"
                                                         th:alt="${image.imageTitle}"
                                                         class="d-block w-100">
                                                </div>
                                            </div>
                                            <button class="carousel-control-prev" type="button"
                                                    th:data-bs-target="'#carousel-' + ${roomType.id}"
                                                    data-bs-slide="prev">
                                                <span class="carousel-control-prev-icon"></span>
                                            </button>
                                            <button class="carousel-control-next" type="button"
                                                    th:data-bs-target="'#carousel-' + ${roomType.id}"
                                                    data-bs-slide="next">
                                                <span class="carousel-control-next-icon"></span>
                                            </button>
                                        </div>

                                        <img th:unless="${roomType.hasImages()}"
                                             src="https://images.unsplash.com/photo-1611892440504-42a792e24d32"
                                             alt="Default room image" class="d-block w-100">

                                        <div class="price-badge">
                                            <span th:if="${roomType.hasPromotion()}"
                                                  class="text-muted text-decoration-line-through me-2">
                                                <span th:text="${roomType.formattedOriginalPrice}">0₫</span>
                                            </span>
                                            <span class="fw-bold text-danger"
                                                  th:text="${roomType.formattedPrice}">0₫</span>
                                        </div>
                                    </div>
                                    <div class="service-content">
                                        <h5 class="service-title heading-font" th:text="${roomType.name}">Room Type Name</h5>
                                        <div class="rating mb-2">
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="fas fa-star"></i>
                                            <i class="far fa-star"></i>
                                            <span class="text-muted">(24)</span>
                                        </div>
                                        <p class="service-description" th:text="${roomType.description}">Description</p>

                                        <div class="amenities-tags">
                                            <span class="amenity-tag">
                                                <i class="fas fa-users me-1"></i>
                                                <span th:text="${roomType.maxOccupancy}">2</span> khách
                                            </span>
                                            <span class="amenity-tag">
                                                <i class="fas fa-bed me-1"></i>
                                                <span th:text="${roomType.bedType}">Double</span>
                                            </span>
                                            <span class="amenity-tag">
                                                <i class="fas fa-expand-arrows-alt me-1"></i>
                                                <span th:text="${roomType.roomSize}">25</span>m²
                                            </span>
                                        </div>

                                        <div class="service-actions">
                                            <div class="action-buttons d-flex gap-2">
                                                <a th:href="@{/room-types/{id}(id=${roomType.id})}"
                                                   class="btn btn-outline-luxury btn-sm me-2">
                                                    <i class="fas fa-eye me-1"></i>Chi tiết
                                                </a>
                                                <button class="btn btn-luxury btn-sm"
                                                        th:onclick="'bookRoom(' + ${roomType.id} + ')'">
                                                    <i class="fas fa-calendar-plus me-1"></i>Đặt phòng
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="tab-pane fade" id="restaurant" role="tabpanel"
                 th:classappend="${branch.type.name() == 'RESTAURANT'} ? 'show active' : ''"
                 th:if="${branch.type.name() == 'RESTAURANT' or branch.type.name() == 'BOTH'}">

                <div class="container-fluid px-0">
                    <!-- Category Filter Pills (Thay thế cho sidebar filter) -->
                    <div class="category-filter-section mb-4">
                        <div class="d-flex justify-content-between align-items-center mb-3">
                            <h4 class="mb-0">
                                <span>Tìm thấy </span>
                                <span id="foodCount" class="text-primary" th:text="${#lists.size(menuItems)}">0</span>
                                <span> món ăn</span>
                            </h4>
                            <select class="form-select sort-select" id="foodSort">
                                <option>Sắp xếp: Phù hợp nhất</option>
                                <option>Giá thấp đến cao</option>
                                <option>Giá cao đến thấp</option>
                                <option>Đánh giá cao nhất</option>
                            </select>
                        </div>

                        <!-- Category Pills -->
                        <div class="category-pills-wrapper" th:if="${menuCategories != null and !menuCategories.isEmpty()}">
                            <button class="category-pill-btn active" data-category="all">
                                <i class="fas fa-utensils me-2"></i>
                                <span>Tất cả</span>
                            </button>
                            <button class="category-pill-btn"
                                    th:each="category : ${menuCategories}"
                                    th:data-category="${category.id}">
                                <i class="fas fa-pizza-slice me-2"></i>
                                <span th:text="${category.name}">Category</span>
                                <span class="pill-badge" th:text="${category.menuItemCount}">0</span>
                            </button>
                        </div>
                    </div>

                    <!-- Menu Items Grid -->
                    <div class="menu-items-grid" id="foodGrid">
                        <div class="menu-item-card"
                             th:each="item : ${menuItems}"
                             th:if="${menuItems != null and !menuItems.isEmpty()}"
                             th:data-category="${item.categoryId}"
                             th:data-price="${item.price}"
                             th:data-available="${item.isAvailable}">

                            <div class="menu-card-inner">
                                <!-- Image Section -->
                                <div class="menu-card-image">
                                    <img th:src="${item.imageUrl != null ? item.imageUrl : 'https://images.unsplash.com/photo-1546069901-ba9599a7e63c'}"
                                         th:alt="${item.name}">
                                    <div class="image-overlay"></div>

                                    <!-- Category Badge -->
                                    <div class="category-badge-overlay" th:text="${item.categoryName}">Category</div>

                                    <!-- Price Badge -->
                                    <div class="price-badge-overlay">
                            <span th:if="${item.hasPromotion()}"
                                  class="old-price-overlay">
                                <span th:text="${#numbers.formatDecimal(item.originalPrice, 0, 'COMMA', 0, 'POINT')}">0</span>₫
                            </span>
                                        <span class="current-price-overlay"
                                              th:text="${#numbers.formatDecimal(item.currentPrice, 0, 'COMMA', 0, 'POINT')}">0</span>₫
                                    </div>

                                    <!-- Status Badge -->
                                    <div class="status-badge-overlay"
                                         th:classappend="${item.isAvailable} ? 'status-available' : 'status-unavailable'">
                                        <i th:class="${item.isAvailable} ? 'fas fa-check-circle' : 'fas fa-times-circle'"></i>
                                        <span th:text="${item.isAvailable} ? 'Có sẵn' : 'Hết món'">Status</span>
                                    </div>
                                </div>

                                <!-- Content Section -->
                                <div class="menu-card-content">
                                    <h5 class="menu-item-title heading-font" th:text="${item.name}">Item Name</h5>
                                    <div class="rating-display mb-2">
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="fas fa-star"></i>
                                        <i class="far fa-star"></i>
                                        <span class="rating-count">(89)</span>
                                    </div>
                                    <p class="menu-item-description" th:text="${item.description}">Description</p>

                                    <!-- Meta Information -->
                                    <div class="menu-item-meta">
                            <span class="meta-item" th:if="${item.preparationTime != null}">
                                <i class="fas fa-clock"></i>
                                <span th:text="${item.preparationTime}">15</span> phút
                            </span>
                                        <span class="meta-item" th:if="${item.calories != null}">
                                <i class="fas fa-fire"></i>
                                <span th:text="${item.calories}">250</span> kcal
                            </span>
                                    </div>

                                    <!-- Actions -->
                                    <div class="menu-card-actions">
                                        <div class="action-buttons-group">
                                            <a th:href="@{'/menu-items/' + ${item.id}}"
                                               class="btn-action btn-view-detail">
                                                <i class="fas fa-eye"></i>
                                                <span>Chi tiết</span>
                                            </a>
                                            <button class="btn-action btn-order-now"
                                                    th:onclick="'orderFood(' + ${item.id} + ')'"
                                                    th:disabled="${!item.isAvailable}">
                                                <i th:class="${item.isAvailable} ? 'fas fa-cart-plus' : 'fas fa-ban'"></i>
                                                <span th:text="${item.isAvailable} ? 'Đặt ngay' : 'Hết món'">Đặt Ngay</span>
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- No Menu Items Message -->
                    <div th:if="${menuItems == null or menuItems.isEmpty()}" class="empty-state-section">
                        <div class="empty-state-content">
                            <i class="fas fa-utensils"></i>
                            <h5>Chưa có thông tin thực đơn</h5>
                            <p>Chi nhánh này hiện chưa cập nhật thực đơn.</p>
                        </div>
                    </div>

                    <!-- Restaurant Booking Form -->
                    <div class="booking-form-section" th:if="${tables != null and !tables.isEmpty()}">
                        <div class="booking-form-container">
                            <div class="booking-form-header-section">
                                <div class="header-icon">
                                    <i class="fas fa-calendar-check"></i>
                                </div>
                                <h3 class="heading-font">Đặt Bàn Nhà Hàng</h3>
                                <p class="header-subtitle">Vui lòng điền đầy đủ thông tin để đặt bàn</p>
                            </div>

                            <form th:action="@{'/branches/' + ${branch.id} + '/book-table'}"
                                  method="post"
                                  th:object="${bookingRequest}"
                                  class="booking-form needs-validation"
                                  novalidate>

                                <!-- Customer Information -->
                                <div class="form-section">
                                    <div class="section-header-title">
                                        <i class="fas fa-user-circle"></i>
                                        <span>Thông tin khách hàng</span>
                                    </div>

                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label for="customerName" class="form-label-custom">
                                                Họ tên <span class="required-star">*</span>
                                            </label>
                                            <div class="input-with-icon">
                                                <i class="fas fa-user"></i>
                                                <input type="text"
                                                       class="form-control-custom"
                                                       id="customerName"
                                                       th:field="*{customerName}"
                                                       placeholder="Nguyễn Văn A"
                                                       required>
                                            </div>
                                            <div class="invalid-feedback">Vui lòng nhập họ tên</div>
                                        </div>

                                        <div class="col-md-6">
                                            <label for="contactPhone" class="form-label-custom">
                                                Số điện thoại <span class="required-star">*</span>
                                            </label>
                                            <div class="input-with-icon">
                                                <i class="fas fa-phone"></i>
                                                <input type="tel"
                                                       class="form-control-custom"
                                                       id="contactPhone"
                                                       th:field="*{contactPhone}"
                                                       placeholder="0912345678"
                                                       pattern="^(0|\+84)[0-9]{9,10}$"
                                                       required>
                                            </div>
                                            <div class="invalid-feedback">Số điện thoại không hợp lệ</div>
                                        </div>

                                        <div class="col-12">
                                            <label for="customerEmail" class="form-label-custom">
                                                Email <span class="required-star">*</span>
                                            </label>
                                            <div class="input-with-icon">
                                                <i class="fas fa-envelope"></i>
                                                <input type="email"
                                                       class="form-control-custom"
                                                       id="customerEmail"
                                                       th:field="*{customerEmail}"
                                                       placeholder="example@email.com"
                                                       required>
                                            </div>
                                            <div class="invalid-feedback">Email không hợp lệ</div>
                                        </div>
                                    </div>
                                </div>

                                <!-- Booking Information -->
                                <div class="form-section">
                                    <div class="section-header-title">
                                        <i class="fas fa-calendar-alt"></i>
                                        <span>Thông tin đặt bàn</span>
                                    </div>

                                    <div class="row g-3">
                                        <div class="col-md-6">
                                            <label for="bookingDate" class="form-label-custom">
                                                Ngày đặt <span class="required-star">*</span>
                                            </label>
                                            <div class="input-with-icon">
                                                <i class="fas fa-calendar"></i>
                                                <input type="date"
                                                       class="form-control-custom"
                                                       id="bookingDate"
                                                       th:field="*{bookingDate}"
                                                       th:min="${#dates.format(#dates.createNow(), 'yyyy-MM-dd')}"
                                                       required>
                                            </div>
                                            <div class="invalid-feedback">Vui lòng chọn ngày</div>
                                        </div>

                                        <div class="col-md-6">
                                            <label for="bookingTime" class="form-label-custom">
                                                Giờ đặt <span class="required-star">*</span>
                                            </label>
                                            <div class="input-with-icon">
                                                <i class="fas fa-clock"></i>
                                                <input type="time"
                                                       class="form-control-custom"
                                                       id="bookingTime"
                                                       th:field="*{bookingTime}"
                                                       min="07:00"
                                                       max="23:00"
                                                       required>
                                            </div>
                                            <small class="form-hint">
                                                <i class="fas fa-info-circle"></i> Giờ phục vụ: 7:00 - 23:00
                                            </small>
                                            <div class="invalid-feedback">Vui lòng chọn giờ</div>
                                        </div>

                                        <div class="col-12">
                                            <label for="partySize" class="form-label-custom">
                                                Số lượng khách <span class="required-star">*</span>
                                            </label>
                                            <div class="party-size-input">
                                                <button class="party-btn party-btn-minus" type="button" onclick="changePartySize(-1)">
                                                    <i class="fas fa-minus"></i>
                                                </button>
                                                <input type="number"
                                                       class="form-control-custom party-input"
                                                       id="partySize"
                                                       th:field="*{partySize}"
                                                       min="1"
                                                       max="50"
                                                       value="2"
                                                       required>
                                                <button class="party-btn party-btn-plus" type="button" onclick="changePartySize(1)">
                                                    <i class="fas fa-plus"></i>
                                                </button>
                                            </div>
                                            <div class="invalid-feedback">Số lượng khách từ 1-50 người</div>
                                        </div>
                                    </div>

                                    <!-- Table Suggestion Loading -->
                                    <div id="tableSuggestionArea" class="table-suggestion-loading" style="display: none;">
                                        <div class="loading-content">
                                            <div class="spinner-border text-primary" role="status">
                                                <span class="visually-hidden">Loading...</span>
                                            </div>
                                            <span>Đang kiểm tra bàn trống...</span>
                                        </div>
                                    </div>

                                    <!-- Table Suggestion Results -->
                                    <div id="tableSuggestionResult" class="table-suggestions"></div>
                                </div>

                                <!-- Special Requests -->
                                <div class="form-section">
                                    <div class="section-header-title">
                                        <i class="fas fa-comment-dots"></i>
                                        <span>Yêu cầu đặc biệt</span>
                                    </div>

                                    <div class="input-with-icon textarea-wrapper">
                                        <i class="fas fa-pencil-alt"></i>
                                        <textarea class="form-control-custom textarea-custom"
                                                  id="specialRequests"
                                                  th:field="*{specialRequests}"
                                                  rows="4"
                                                  maxlength="500"
                                                  placeholder="VD: Vị trí gần cửa sổ, cần ghế trẻ em, sinh nhật..."></textarea>
                                    </div>
                                    <small class="form-hint">
                                        <i class="fas fa-info-circle"></i> Tối đa 500 ký tự
                                    </small>
                                </div>

                                <!-- Important Notes -->
                                <div class="important-notes">
                                    <div class="notes-header">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        <span>Lưu ý quan trọng</span>
                                    </div>
                                    <ul class="notes-list">
                                        <li>
                                            <i class="fas fa-check-circle"></i>
                                            Vui lòng đặt bàn trước ít nhất <strong>2 giờ</strong>
                                        </li>
                                        <li>
                                            <i class="fas fa-check-circle"></i>
                                            Bàn chỉ được giữ <strong>15 phút</strong> kể từ giờ đặt
                                        </li>
                                        <li>
                                            <i class="fas fa-check-circle"></i>
                                            Nếu muốn hủy, vui lòng thông báo trước ít nhất <strong>2 giờ</strong>
                                        </li>
                                        <li>
                                            <i class="fas fa-check-circle"></i>
                                            Chúng tôi sẽ gửi <strong>email xác nhận</strong> sau khi nhận đặt bàn
                                        </li>
                                    </ul>
                                </div>

                                <!-- Form Actions -->
                                <div class="form-actions">
                                    <button type="button" class="btn-form-action btn-reset-form" onclick="resetForm()">
                                        <i class="fas fa-redo"></i>
                                        <span>Làm mới</span>
                                    </button>
                                    <button type="submit" class="btn-form-action btn-submit-form">
                                        <i class="fas fa-check-circle"></i>
                                        <span>Xác nhận đặt bàn</span>
                                    </button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

<!-- Mobile Filter Offcanvas for Rooms -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="roomFilters">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Bộ lọc phòng</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        <div class="filter-widget">
            <h6>Loại phòng</h6>
            <select class="form-select">
                <option value="">Tất cả loại phòng</option>
                <option th:each="roomType : ${roomTypes}"
                        th:value="${roomType.id}"
                        th:text="${roomType.name}">Room Type</option>
            </select>
        </div>

        <div class="filter-widget">
            <h6>Khoảng giá (VNĐ/đêm)</h6>
            <input type="range" class="form-range" min="500000" max="5000000" step="100000" value="2000000">
            <div class="d-flex justify-content-between">
                <span>500K</span>
                <span>2.000K</span>
                <span>5.000K</span>
            </div>
        </div>

        <button class="btn btn-luxury w-100 mt-3">Áp dụng bộ lọc</button>
    </div>
</div>

<!-- Mobile Filter Offcanvas for Restaurant -->
<div class="offcanvas offcanvas-start" tabindex="-1" id="restaurantFilters">
    <div class="offcanvas-header">
        <h5 class="offcanvas-title">Bộ lọc món ăn</h5>
        <button type="button" class="btn-close" data-bs-dismiss="offcanvas"></button>
    </div>
    <div class="offcanvas-body">
        <div class="filter-widget">
            <h6>Danh mục món</h6>
            <select class="form-select">
                <option value="">Tất cả danh mục</option>
                <option th:each="category : ${menuCategories}"
                        th:value="${category.id}"
                        th:text="${category.name + ' (' + category.menuItemCount + ')'}">Category</option>
            </select>
        </div>

        <div class="filter-widget">
            <h6>Khoảng giá (VNĐ)</h6>
            <input type="range" class="form-range" min="50000" max="500000" step="10000" value="200000">
            <div class="d-flex justify-content-between">
                <span>50K</span>
                <span>200K</span>
                <span>500K</span>
            </div>
        </div>

        <button class="btn btn-luxury w-100 mt-3">Áp dụng bộ lọc</button>
    </div>
</div>

<!-- Loading Modal -->
<div class="modal fade" id="loadingModal" tabindex="-1" data-bs-backdrop="static">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-body text-center py-4">
                <div class="spinner mx-auto mb-3"></div>
                <p class="mb-0">Đang xử lý...</p>
            </div>
        </div>
    </div>
</div>

<!-- Bootstrap JS -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<script th:inline="javascript">
    // Branch data from Thymeleaf
    const branchData = {
        id: /*[[${branch.id}]]*/ 0,
        type: /*[[${branch.type}]]*/ 'BOTH'
    };

    // Initialize on page load
    document.addEventListener('DOMContentLoaded', function() {
        initializePage();
        setupEventListeners();
        setupFilters();
    });

    function initializePage() {
        // Initialize tooltips
        const tooltipTriggerList = [].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]'));
        tooltipTriggerList.map(function (tooltipTriggerEl) {
            return new bootstrap.Tooltip(tooltipTriggerEl);
        });

        // Auto-activate first tab based on branch type
        if (branchData.type === 'RESTAURANT') {
            const restaurantTab = document.getElementById('restaurant-tab');
            const restaurantPane = document.getElementById('restaurant');
            const hotelPane = document.getElementById('hotel');

            if (restaurantTab && restaurantPane) {
                // Remove active from hotel tab/pane
                if (hotelPane) {
                    hotelPane.classList.remove('show', 'active');
                }

                // Activate restaurant tab/pane
                restaurantTab.classList.add('active');
                restaurantPane.classList.add('show', 'active');
            }
        }
    }

    function setupEventListeners() {
        // Price range sliders
        const roomPriceRange = document.getElementById('roomPriceRange');
        const roomPriceValue = document.getElementById('roomPriceValue');
        const foodPriceRange = document.getElementById('foodPriceRange');
        const foodPriceValue = document.getElementById('foodPriceValue');

        if (roomPriceRange && roomPriceValue) {
            roomPriceRange.addEventListener('input', function() {
                const value = parseInt(this.value);
                roomPriceValue.textContent = (value / 1000).toFixed(0) + '.000K';
                filterRooms();
            });
        }

        if (foodPriceRange && foodPriceValue) {
            foodPriceRange.addEventListener('input', function() {
                const value = parseInt(this.value);
                foodPriceValue.textContent = (value / 1000).toFixed(0) + 'K';
                filterMenuItems();
            });
        }

        // Sort handlers
        const roomSort = document.getElementById('roomSort');
        if (roomSort) {
            roomSort.addEventListener('change', function() {
                sortRooms(this.value);
            });
        }

        const foodSort = document.getElementById('foodSort');
        if (foodSort) {
            foodSort.addEventListener('change', function() {
                sortMenuItems(this.value);
            });
        }
    }

    function setupFilters() {
        // Category filter functionality
        const categoryFilters = document.querySelectorAll('.category-filter');
        const menuItems = document.querySelectorAll('.menu-item');

        categoryFilters.forEach(filter => {
            filter.addEventListener('click', function() {
                // Remove active class from all filters
                categoryFilters.forEach(f => f.classList.remove('active'));
                // Add active class to clicked filter
                this.classList.add('active');

                const categoryId = this.getAttribute('data-category');

                menuItems.forEach(item => {
                    if (categoryId === 'all' || item.getAttribute('data-category') === categoryId) {
                        item.style.display = 'block';
                        item.style.animation = 'fadeInUp 0.5s ease-out';
                    } else {
                        item.style.animation = 'fadeOutDown 0.3s ease-out';
                        setTimeout(() => {
                            item.style.display = 'none';
                        }, 300);
                    }
                });

                updateFoodCount();
            });
        });

        // Filter change handlers
        const roomTypeFilter = document.getElementById('roomTypeFilter');
        if (roomTypeFilter) {
            roomTypeFilter.addEventListener('change', filterRooms);
        }

        const categoryFilter = document.getElementById('categoryFilter');
        if (categoryFilter) {
            categoryFilter.addEventListener('change', filterMenuItems);
        }

        // Checkbox filters
        const checkboxFilters = document.querySelectorAll('.filter-widget input[type="checkbox"]');
        checkboxFilters.forEach(checkbox => {
            checkbox.addEventListener('change', function() {
                if (this.closest('#rooms')) {
                    filterRooms();
                } else {
                    filterMenuItems();
                }
            });
        });
    }

    // Room filtering and sorting
    function filterRooms() {
        const roomTypeFilter = document.getElementById('roomTypeFilter').value;
        const priceRange = document.getElementById('roomPriceRange').value;
        const roomCards = document.querySelectorAll('.room-type-card');

        let visibleCount = 0;

        roomCards.forEach(card => {
            let show = true;

            // Filter by room type
            if (roomTypeFilter && !card.dataset.roomTypeId === roomTypeFilter) {
                show = false;
            }

            // Filter by price (you would need to add data-price to cards)
            // ... price filtering logic

            if (show) {
                card.style.display = 'block';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        document.getElementById('roomCount').textContent = visibleCount;
    }

    function sortRooms(sortBy) {
        const roomsGrid = document.getElementById('roomsGrid');
        const roomCards = Array.from(roomsGrid.children);

        roomCards.sort((a, b) => {
            switch(sortBy) {
                case 'Giá thấp đến cao':
                    return parseFloat(a.dataset.price || '0') - parseFloat(b.dataset.price || '0');
                case 'Giá cao đến thấp':
                    return parseFloat(b.dataset.price || '0') - parseFloat(a.dataset.price || '0');
                // Add more sorting options
                default:
                    return 0;
            }
        });

        roomCards.forEach(card => roomsGrid.appendChild(card));
    }

    // Menu filtering and sorting
    function filterMenuItems() {
        const categoryFilter = document.getElementById('categoryFilter').value;
        const priceRange = document.getElementById('foodPriceRange').value;
        const availableOnly = document.getElementById('availableOnly').checked;
        const menuItems = document.querySelectorAll('.menu-item');

        let visibleCount = 0;

        menuItems.forEach(item => {
            let show = true;

            // Filter by category
            if (categoryFilter && item.dataset.category !== categoryFilter) {
                show = false;
            }

            // Filter by price
            const itemPrice = parseFloat(item.dataset.price || '0');
            if (itemPrice > parseFloat(priceRange)) {
                show = false;
            }

            // Filter by availability
            if (availableOnly && item.dataset.available !== 'true') {
                show = false;
            }

            if (show) {
                item.style.display = 'block';
                visibleCount++;
            } else {
                item.style.display = 'none';
            }
        });

        document.getElementById('foodCount').textContent = visibleCount;
    }

    function sortMenuItems(sortBy) {
        const foodGrid = document.getElementById('foodGrid');
        const menuItems = Array.from(foodGrid.children);

        menuItems.sort((a, b) => {
            switch(sortBy) {
                case 'Giá thấp đến cao':
                    return parseFloat(a.dataset.price || '0') - parseFloat(b.dataset.price || '0');
                case 'Giá cao đến thấp':
                    return parseFloat(b.dataset.price || '0') - parseFloat(a.dataset.price || '0');
                default:
                    return 0;
            }
        });

        menuItems.forEach(item => foodGrid.appendChild(item));
    }

    function updateFoodCount() {
        const visibleItems = document.querySelectorAll('.menu-item:not([style*="display: none"])').length;
        document.getElementById('foodCount').textContent = visibleItems;
    }

    // Business functions
    function bookRoom(roomTypeId) {
        showLoading();
        setTimeout(() => {
            hideLoading();
            alert('Chuyển đến trang đặt phòng cho loại phòng ID: ' + roomTypeId);
            // window.location.href = '/booking/room/' + roomTypeId;
        }, 1000);
    }

    function orderFood(itemId) {
        showLoading();
        setTimeout(() => {
            hideLoading();
            const itemCard = document.querySelector(`[onclick="orderFood(${itemId})"]`)
                .closest('.service-card');
            const itemName = itemCard.querySelector('.service-title').textContent;

            if (confirm(`Thêm "${itemName}" vào giỏ hàng?`)) {
                showSuccessMessage('Đã thêm vào giỏ hàng!');
            }
        }, 500);
    }

    function selectTable(tableId) {
        const tableElement = document.querySelector(`[onclick="selectTable(${tableId})"]`);
        const isAvailable = tableElement.classList.contains('table-available');

        if (!isAvailable) {
            alert('Bàn này hiện không khả dụng.');
            return;
        }

        showLoading();
        setTimeout(() => {
            hideLoading();
            const tableNumber = tableElement.querySelector('span').textContent;
            if (confirm(`Đặt bàn số ${tableNumber}?`)) {
                alert(`Chuyển đến trang đặt bàn số ${tableNumber}`);
            }
        }, 500);
    }

    // Utility functions
    function showLoading() {
        const modal = new bootstrap.Modal(document.getElementById('loadingModal'));
        modal.show();
    }

    function hideLoading() {
        const modal = bootstrap.Modal.getInstance(document.getElementById('loadingModal'));
        if (modal) {
            modal.hide();
        }
    }

    function showSuccessMessage(message) {
        const toastHtml = `
                <div class="toast align-items-center text-white bg-success border-0" role="alert">
                    <div class="d-flex">
                        <div class="toast-body">
                            <i class="fas fa-check-circle me-2"></i>${message}
                        </div>
                        <button type="button" class="btn-close btn-close-white me-2 m-auto" data-bs-dismiss="toast"></button>
                    </div>
                </div>
            `;

        let toastContainer = document.querySelector('.toast-container');
        if (!toastContainer) {
            toastContainer = document.createElement('div');
            toastContainer.className = 'toast-container position-fixed top-0 end-0 p-3';
            toastContainer.style.zIndex = '9999';
            document.body.appendChild(toastContainer);
        }

        toastContainer.insertAdjacentHTML('beforeend', toastHtml);
        const toast = new bootstrap.Toast(toastContainer.lastElementChild);
        toast.show();

        toastContainer.lastElementChild.addEventListener('hidden.bs.toast', function() {
            this.remove();
        });
    }

    // Add CSS animations
    const animationCSS = `
            @keyframes fadeInUp {
                from { opacity: 0; transform: translateY(20px); }
                to { opacity: 1; transform: translateY(0); }
            }
            @keyframes fadeOutDown {
                from { opacity: 1; transform: translateY(0); }
                to { opacity: 0; transform: translateY(-20px); }
            }
        `;

    const style = document.createElement('style');
    style.textContent = animationCSS;
    document.head.appendChild(style);

    // Tab switching with dynamic content loading
    document.querySelectorAll('[data-bs-toggle="pill"]').forEach(tab => {
        tab.addEventListener('shown.bs.tab', function(e) {
            const targetId = e.target.getAttribute('data-bs-target').substring(1);

            if (targetId === 'restaurant') {
                // Reset category filter when switching to restaurant tab
                setTimeout(() => {
                    const firstCategoryBtn = document.querySelector('.category-filter');
                    if (firstCategoryBtn && !firstCategoryBtn.classList.contains('active')) {
                        firstCategoryBtn.click();
                    }
                }, 300);
            }
        });
    });

    // Enhanced image lazy loading
    function initLazyLoading() {
        const images = document.querySelectorAll('img[data-src]');
        const imageObserver = new IntersectionObserver((entries) => {
            entries.forEach(entry => {
                if (entry.isIntersecting) {
                    const img = entry.target;
                    img.src = img.dataset.src;
                    img.removeAttribute('data-src');
                    imageObserver.unobserve(img);

                    // Add fade in animation
                    img.style.opacity = '0';
                    img.onload = function() {
                        img.style.transition = 'opacity 0.3s ease';
                        img.style.opacity = '1';
                    };
                }
            });
        });

        images.forEach(img => imageObserver.observe(img));
    }

    // Mobile menu improvements for offcanvas
    document.addEventListener('DOMContentLoaded', function() {
        // Close mobile offcanvas when clicking apply filter
        document.querySelectorAll('.offcanvas .btn-luxury').forEach(btn => {
            btn.addEventListener('click', function() {
                const offcanvas = this.closest('.offcanvas');
                const bsOffcanvas = bootstrap.Offcanvas.getInstance(offcanvas);
                if (bsOffcanvas) {
                    bsOffcanvas.hide();
                }

                // Apply filters based on the offcanvas type
                const isRoomFilter = offcanvas.id === 'roomFilters';
                if (isRoomFilter) {
                    filterRooms();
                } else {
                    filterMenuItems();
                }
            });
        });

        // Initialize lazy loading
        initLazyLoading();
    });

    // Advanced search functionality
    function initAdvancedSearch() {
        // Add search input to filters
        const searchInputHtml = `
                <div class="filter-widget">
                    <h6>Tìm kiếm</h6>
                    <input type="text" class="form-control" id="searchInput" placeholder="Tìm theo tên...">
                </div>
            `;

        // Add search to room filters
        const roomFilterSection = document.querySelector('#rooms .filter-section');
        if (roomFilterSection) {
            roomFilterSection.insertAdjacentHTML('beforeend', searchInputHtml.replace('searchInput', 'roomSearchInput'));
        }

        // Add search to restaurant filters
        const restaurantFilterSection = document.querySelector('#restaurant .filter-section');
        if (restaurantFilterSection) {
            restaurantFilterSection.insertAdjacentHTML('beforeend', searchInputHtml.replace('searchInput', 'foodSearchInput'));
        }

        // Bind search events
        const roomSearch = document.getElementById('roomSearchInput');
        if (roomSearch) {
            roomSearch.addEventListener('input', debounce(filterRooms, 300));
        }

        const foodSearch = document.getElementById('foodSearchInput');
        if (foodSearch) {
            foodSearch.addEventListener('input', debounce(filterMenuItems, 300));
        }
    }

    // Debounce function for search
    function debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
            const later = () => {
                clearTimeout(timeout);
                func(...args);
            };
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
        };
    }

    // Enhanced filter functions with search
    function filterRoomsWithSearch() {
        const searchTerm = document.getElementById('roomSearchInput')?.value.toLowerCase() || '';
        const roomTypeFilter = document.getElementById('roomTypeFilter').value;
        const priceRange = document.getElementById('roomPriceRange').value;
        const roomCards = document.querySelectorAll('.room-type-card');

        let visibleCount = 0;

        roomCards.forEach(card => {
            let show = true;
            const title = card.querySelector('.service-title').textContent.toLowerCase();
            const description = card.querySelector('.service-description').textContent.toLowerCase();

            // Filter by search term
            if (searchTerm && !title.includes(searchTerm) && !description.includes(searchTerm)) {
                show = false;
            }

            // Filter by room type
            if (roomTypeFilter && card.dataset.roomTypeId !== roomTypeFilter) {
                show = false;
            }

            if (show) {
                card.style.display = 'block';
                card.style.animation = 'fadeInUp 0.5s ease-out';
                visibleCount++;
            } else {
                card.style.display = 'none';
            }
        });

        document.getElementById('roomCount').textContent = visibleCount;
    }

    function filterMenuItemsWithSearch() {
        const searchTerm = document.getElementById('foodSearchInput')?.value.toLowerCase() || '';
        const categoryFilter = document.getElementById('categoryFilter').value;
        const priceRange = document.getElementById('foodPriceRange').value;
        const availableOnly = document.getElementById('availableOnly').checked;
        const menuItems = document.querySelectorAll('.menu-item');

        let visibleCount = 0;

        menuItems.forEach(item => {
            let show = true;
            const title = item.querySelector('.service-title').textContent.toLowerCase();
            const description = item.querySelector('.service-description').textContent.toLowerCase();

            // Filter by search term
            if (searchTerm && !title.includes(searchTerm) && !description.includes(searchTerm)) {
                show = false;
            }

            // Filter by category
            if (categoryFilter && item.dataset.category !== categoryFilter) {
                show = false;
            }

            // Filter by price
            const itemPrice = parseFloat(item.dataset.price || '0');
            if (itemPrice > parseFloat(priceRange)) {
                show = false;
            }

            // Filter by availability
            if (availableOnly && item.dataset.available !== 'true') {
                show = false;
            }

            if (show) {
                item.style.display = 'block';
                item.style.animation = 'fadeInUp 0.5s ease-out';
                visibleCount++;
            } else {
                item.style.display = 'none';
            }
        });

        document.getElementById('foodCount').textContent = visibleCount;
    }

    // Update filter functions to use enhanced versions
    filterRooms = filterRoomsWithSearch;
    filterMenuItems = filterMenuItemsWithSearch;

    // Print functionality
    function printMenu() {
        const printContent = document.getElementById('restaurant').cloneNode(true);
        const printWindow = window.open('', '_blank');

        printWindow.document.write(`
                <html>
                    <head>
                        <title>Thực đơn - ${branchData.name}</title>
                        <style>
                            body { font-family: Arial, sans-serif; }
                            .service-card { border: 1px solid #ddd; margin: 10px 0; padding: 15px; }
                            .service-title { font-weight: bold; margin-bottom: 10px; }
                            .price-badge { font-weight: bold; color: #c9a96e; }
                            .amenities-tags { margin: 10px 0; }
                            .amenity-tag { background: #f0f0f0; padding: 3px 8px; margin: 2px; border-radius: 10px; display: inline-block; }
                        </style>
                    </head>
                    <body>
                        ${printContent.innerHTML}
                    </body>
                </html>
            `);

        printWindow.document.close();
        printWindow.print();
    }

    // Share functionality
    function shareBranch() {
        if (navigator.share) {
            navigator.share({
                title: document.title,
                text: 'Xem chi tiết chi nhánh này tại Luxury Resort',
                url: window.location.href
            });
        } else {
            // Fallback: copy to clipboard
            navigator.clipboard.writeText(window.location.href).then(() => {
                showSuccessMessage('Đã copy link vào clipboard!');
            });
        }
    }

    // Floating action buttons
    document.addEventListener('DOMContentLoaded', function() {
        const fabHtml = `
                <div class="floating-action-buttons">
                    <button class="fab fab-primary" onclick="shareBranch()" title="Chia sẻ">
                        <i class="fas fa-share-alt"></i>
                    </button>
                    <button class="fab fab-secondary" onclick="window.history.back()" title="Quay lại">
                        <i class="fas fa-arrow-left"></i>
                    </button>
                </div>
            `;

        document.body.insertAdjacentHTML('beforeend', fabHtml);

        // Add FAB styles
        const fabStyles = `
                .floating-action-buttons {
                    position: fixed;
                    bottom: 20px;
                    right: 20px;
                    display: flex;
                    flex-direction: column;
                    gap: 10px;
                    z-index: 1000;
                }

                .fab {
                    width: 56px;
                    height: 56px;
                    border-radius: 50%;
                    border: none;
                    color: white;
                    font-size: 20px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
                    transition: all 0.3s ease;
                    cursor: pointer;
                }

                .fab:hover {
                    transform: scale(1.1);
                    box-shadow: 0 6px 20px rgba(0,0,0,0.4);
                }

                .fab-primary { background: var(--primary-color); }
                .fab-secondary { background: #6c757d; }

                @media (max-width: 768px) {
                    .floating-action-buttons {
                        bottom: 15px;
                        right: 15px;
                    }
                    .fab {
                        width: 48px;
                        height: 48px;
                        font-size: 18px;
                    }
                }
            `;

        const fabStyle = document.createElement('style');
        fabStyle.textContent = fabStyles;
        document.head.appendChild(fabStyle);

        // Initialize advanced search
        setTimeout(initAdvancedSearch, 1000);
    });

    // Smooth scroll for anchor links
    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener('click', function (e) {
            e.preventDefault();
            const target = document.querySelector(this.getAttribute('href'));
            if (target) {
                target.scrollIntoView({
                    behavior: 'smooth',
                    block: 'start'
                });
            }
        });
    });

    // Thay đổi số lượng khách
    function changePartySize(delta) {
        const input = document.getElementById('partySize');
        let value = parseInt(input.value) || 2;
        value = Math.max(1, Math.min(50, value + delta));
        input.value = value;
        checkTableAvailability();
    }

    // Kiểm tra bàn trống khi thay đổi thông tin
    document.getElementById('bookingDate')?.addEventListener('change', checkTableAvailability);
    document.getElementById('bookingTime')?.addEventListener('change', checkTableAvailability);
    document.getElementById('partySize')?.addEventListener('change', checkTableAvailability);

    function checkTableAvailability() {
        const date = document.getElementById('bookingDate').value;
        const time = document.getElementById('bookingTime').value;
        const partySize = document.getElementById('partySize').value;

        if (!date || !time || !partySize) return;

        const branchId = /*[[${branch.id}]]*/ 0;
        const suggestionArea = document.getElementById('tableSuggestionArea');
        const resultArea = document.getElementById('tableSuggestionResult');

        suggestionArea.style.display = 'block';
        resultArea.innerHTML = '';

        fetch(`/api/branches/${branchId}/table-suggestions?partySize=${partySize}&date=${date}&time=${time}`)
            .then(response => response.json())
            .then(data => {
                suggestionArea.style.display = 'none';
                displayTableSuggestions(data);
            })
            .catch(error => {
                suggestionArea.style.display = 'none';
                console.error('Error:', error);
            });
    }

    function displayTableSuggestions(data) {
        const resultArea = document.getElementById('tableSuggestionResult');

        if (!data.canAccommodate) {
            resultArea.innerHTML = `
            <div class="alert alert-danger">
                <i class="fas fa-times-circle me-2"></i>
                ${data.message}
            </div>
        `;
            return;
        }

        let html = `
        <div class="alert alert-success">
            <i class="fas fa-check-circle me-2"></i>
            ${data.message}
        </div>
        <h6 class="mt-3 mb-3">Chọn phương án đặt bàn:</h6>
    `;

        data.suggestions.forEach((suggestion, index) => {
            const tableIds = suggestion.tables.map(t => t.id).join(',');
            html += `
            <div class="suggestion-card" onclick="selectSuggestion(${index}, '${tableIds}')">
                <div class="d-flex justify-content-between align-items-center">
                    <div>
                        <strong>${suggestion.description}</strong>
                        <div class="mt-2">
                            ${suggestion.tables.map(t =>
                `<span class="table-badge">Bàn ${t.tableNumber} (${t.capacity} chỗ)</span>`
            ).join('')}
                        </div>
                    </div>
                    <div class="text-end">
                        <div class="badge bg-primary">
                            ${suggestion.totalCapacity} chỗ
                        </div>
                    </div>
                </div>
            </div>
        `;
        });

        resultArea.innerHTML = html;
    }

    function selectSuggestion(index, tableIds) {
        // Remove selected class from all
        document.querySelectorAll('.suggestion-card').forEach(card => {
            card.classList.remove('selected');
        });

        // Add selected class
        document.querySelectorAll('.suggestion-card')[index].classList.add('selected');

        // Store selected table IDs (you may need hidden inputs for this)
        console.log('Selected tables:', tableIds);
    }

    function resetForm() {
        document.querySelector('form').reset();
        document.getElementById('tableSuggestionResult').innerHTML = '';
        document.getElementById('tableSuggestionArea').style.display = 'none';
    }

    // Form validation
    (function() {
        'use strict';
        const forms = document.querySelectorAll('.needs-validation');
        Array.from(forms).forEach(form => {
            form.addEventListener('submit', event => {
                if (!form.checkValidity()) {
                    event.preventDefault();
                    event.stopPropagation();
                }
                form.classList.add('was-validated');
            }, false);
        });
    })();

    // Add scroll-based animations
    const observerOptions = {
        threshold: 0.1,
        rootMargin: '0px 0px -100px 0px'
    };

    const observer = new IntersectionObserver(function(entries) {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                entry.target.style.animation = 'fadeInUp 0.6s ease-out forwards';
            }
        });
    }, observerOptions);

    // Observe all service cards
    setTimeout(() => {
        document.querySelectorAll('.service-card').forEach(card => {
            observer.observe(card);
        });
    }, 500);

    // Auto-refresh functionality for real-time updates
    function startAutoRefresh() {
        // Refresh every 2 minutes for table status
        setInterval(() => {
            if (document.querySelector('#restaurant.active')) {
                refreshTableStatus();
            }
        }, 120000);
    }

    function refreshTableStatus() {
        fetch(`/api/branches/${branchData.id}/tables/availability`)
            .then(response => response.json())
            .then(data => {
                updateTableDisplay(data.tables);
            })
            .catch(error => {
                console.error('Auto-refresh failed:', error);
            });
    }

    function updateTableDisplay(tables) {
        tables.forEach(table => {
            const tableElement = document.querySelector(`[onclick="selectTable(${table.id})"]`);
            if (tableElement) {
                // Remove old status classes
                tableElement.classList.remove('table-available', 'table-occupied', 'table-reserved');
                // Add new status class
                tableElement.classList.add('table-' + table.status.toLowerCase());
            }
        });
    }

    // Initialize auto-refresh
    setTimeout(startAutoRefresh, 5000);

    // Add keyboard shortcuts
    document.addEventListener('keydown', function(e) {
        // Escape key to close modals/offcanvas
        if (e.key === 'Escape') {
            const openModals = document.querySelectorAll('.modal.show');
            openModals.forEach(modal => {
                const modalInstance = bootstrap.Modal.getInstance(modal);
                if (modalInstance) modalInstance.hide();
            });

            const openOffcanvas = document.querySelectorAll('.offcanvas.show');
            openOffcanvas.forEach(offcanvas => {
                const offcanvasInstance = bootstrap.Offcanvas.getInstance(offcanvas);
                if (offcanvasInstance) offcanvasInstance.hide();
            });
        }

        // Ctrl+F for search
        if (e.ctrlKey && e.key === 'f') {
            e.preventDefault();
            const activeTab = document.querySelector('.tab-pane.active');
            const searchInput = activeTab.querySelector('input[type="text"]');
            if (searchInput) {
                searchInput.focus();
            }
        }
    });

    console.log('Branch Detail Page Initialized Successfully');

     function orderFood(itemId) {
     const userId = /*[[${session.userId}]]*/ null;

    if (!userId) {
        if (confirm('Vui lòng đăng nhập để đặt món. Chuyển đến trang đăng nhập?')) {
            const currentUrl = window.location.pathname;
            sessionStorage.setItem('redirectAfterLogin', currentUrl);
            window.location.href = '/customer/login?redirect=' + encodeURIComponent(currentUrl);
        }
        return;
    }

    // ✅ MỚI: Hiển thị modal chọn hành động
    showOrderOptionsModal(itemId);
    }

    /**
     * ✅ MỚI: Hiển thị modal chọn: Thêm giỏ hoặc Đặt ngay
     */
    function showOrderOptionsModal(itemId) {
        const itemCard = document.querySelector(`[onclick="orderFood(${itemId})"]`)?.closest('.menu-card-inner');
        const itemName = itemCard?.querySelector('.menu-item-title')?.textContent || 'Món ăn';
        const itemPrice = itemCard?.querySelector('.current-price-overlay')?.textContent || '0';

        const modalHtml = `
        <div class="modal fade" id="orderOptionsModal" tabindex="-1" data-bs-backdrop="static">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-utensils me-2"></i>Chọn hành động
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body text-center">
                        <div class="mb-4">
                            <h6>${itemName}</h6>
                            <p class="text-muted mb-0">Giá: <strong class="text-danger">${itemPrice}₫</strong></p>
                        </div>

                        <div class="d-grid gap-3">
                            <button class="btn btn-luxury btn-lg" onclick="addToCartAction(${itemId})">
                                <i class="fas fa-shopping-cart me-2"></i>
                                Thêm vào giỏ hàng
                            </button>
                            <button class="btn btn-outline-primary btn-lg" onclick="quickOrderAction(${itemId})">
                                <i class="fas fa-bolt me-2"></i>
                                Đặt món ngay
                            </button>
                        </div>

                        <div class="alert alert-info mt-3 mb-0">
                            <small>
                                <i class="fas fa-info-circle me-1"></i>
                                <strong>Thêm giỏ:</strong> Mua thêm món khác<br>
                                <strong>Đặt ngay:</strong> Bỏ qua giỏ hàng, thanh toán luôn
                            </small>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    `;

        // Xóa modal cũ
        const oldModal = document.getElementById('orderOptionsModal');
        if (oldModal) oldModal.remove();

        // Thêm modal mới
        document.body.insertAdjacentHTML('beforeend', modalHtml);
        const modal = new bootstrap.Modal(document.getElementById('orderOptionsModal'));
        modal.show();
    }

    /**
     * ✅ Action: Thêm vào giỏ hàng
     */
    function addToCartAction(itemId) {
        showLoading();

        fetch('/api/cart/quick-add', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ menuItemId: itemId, quantity: 1 })
        })
            .then(response => response.json())
            .then(data => {
                hideLoading();

                // Đóng modal
                const modal = bootstrap.Modal.getInstance(document.getElementById('orderOptionsModal'));
                if (modal) modal.hide();

                if (data.success) {
                    // Cập nhật cart counter
                    if (data.cartCount) {
                        updateCartCount(data.cartCount);
                    }

                    // Hiển thị thông báo
                    showSuccessToast('Đã thêm vào giỏ hàng!');

                    // ✅ Optional: Mở chatbot với message xác nhận
                    if (typeof openChatbotWithMessage === 'function') {
                        openChatbotWithMessage('Đã thêm món vào giỏ. Bạn muốn xem giỏ hàng hay tiếp tục mua sắm?');
                    }
                } else {
                    alert('❌ ' + data.message);
                }
            })
            .catch(error => {
                hideLoading();
                alert('❌ Có lỗi xảy ra: ' + error.message);
            });
    }

    /**
     * ✅ Action: Đặt món ngay (Quick Order)
     */
    function quickOrderAction(itemId) {
        showQuantityModal(itemId);
    }

    /**
     * ✅ GIỮ NGUYÊN: Modal chọn số lượng cho Quick Order
     */
    function showQuantityModal(itemId) {
        const itemCard = document.querySelector(`[onclick="orderFood(${itemId})"]`)?.closest('.menu-card-inner');
        const itemName = itemCard?.querySelector('.menu-item-title')?.textContent || 'Món ăn';
        const itemPrice = itemCard?.querySelector('.current-price-overlay')?.textContent || '0';

        const modalHtml = `
        <div class="modal fade" id="quantityModal" tabindex="-1" data-bs-backdrop="static">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">
                    <div class="modal-header">
                        <h5 class="modal-title">
                            <i class="fas fa-shopping-cart me-2"></i>Chọn số lượng
                        </h5>
                        <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                    </div>
                    <div class="modal-body">
                        <div class="text-center mb-3">
                            <h6>${itemName}</h6>
                            <p class="text-muted mb-0">Giá: <strong class="text-danger">${itemPrice}₫</strong></p>
                        </div>

                        <div class="d-flex justify-content-center align-items-center gap-3 my-4">
                            <button class="btn btn-outline-primary btn-lg" onclick="changeModalQuantity(-1)">
                                <i class="fas fa-minus"></i>
                            </button>
                            <input type="number" id="modalQuantityInput"
                                   class="form-control form-control-lg text-center"
                                   value="1" min="1" max="50"
                                   style="width: 100px; font-size: 24px; font-weight: bold;" readonly>
                            <button class="btn btn-outline-primary btn-lg" onclick="changeModalQuantity(1)">
                                <i class="fas fa-plus"></i>
                            </button>
                        </div>

                        <div class="alert alert-info mb-0">
                            <i class="fas fa-info-circle me-2"></i>
                            Bạn sẽ được chuyển đến trang nhập thông tin giao hàng
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                            <i class="fas fa-times me-2"></i>Hủy
                        </button>
                        <button type="button" class="btn btn-luxury" onclick="confirmQuickOrder(${itemId})">
                            <i class="fas fa-bolt me-2"></i>Đặt món ngay
                        </button>
                    </div>
                </div>
            </div>
        </div>
    `;

        const oldModal = document.getElementById('quantityModal');
        if (oldModal) oldModal.remove();

        document.body.insertAdjacentHTML('beforeend', modalHtml);
        const modal = new bootstrap.Modal(document.getElementById('quantityModal'));
        modal.show();
    }

    function changeModalQuantity(delta) {
        const input = document.getElementById('modalQuantityInput');
        let value = parseInt(input.value) || 1;
        value = Math.max(1, Math.min(50, value + delta));
        input.value = value;
    }

    function confirmQuickOrder(itemId) {
        const quantity = parseInt(document.getElementById('modalQuantityInput').value) || 1;
        const branchId = /*[[${branch.id}]]*/ 0;

        showLoading();

        fetch('/quick-order/create', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                menuItemId: itemId,
                branchId: branchId,
                quantity: quantity
            })
        })
            .then(response => response.json())
            .then(data => {
                hideLoading();

                const modal = bootstrap.Modal.getInstance(document.getElementById('quantityModal'));
                if (modal) modal.hide();

                if (data.success) {
                    window.location.href = '/checkout/quick-order/' + data.quickOrderId;
                } else {
                    alert('❌ ' + data.error);
                }
            })
            .catch(error => {
                hideLoading();
                alert('❌ Có lỗi xảy ra: ' + error.message);
            });
    }

    /**
     * ✅ Helper: Update cart count badge
     */
    function updateCartCount(count) {
        const cartBadge = document.querySelector('.cart-count');
        if (cartBadge) {
            cartBadge.textContent = count;
            if (count > 0) {
                cartBadge.style.display = 'inline-block';
            }
        }
    }

    /**
     * ✅ Helper: Show success toast
     */
    function showSuccessToast(message) {
        // Sử dụng Bootstrap toast hoặc custom notification
        const toastHtml = `
        <div class="toast align-items-center text-white bg-success border-0"
             role="alert" style="position: fixed; top: 20px; right: 20px; z-index: 9999;">
            <div class="d-flex">
                <div class="toast-body">
                    <i class="fas fa-check-circle me-2"></i>${message}
                </div>
                <button type="button" class="btn-close btn-close-white me-2 m-auto"
                        data-bs-dismiss="toast"></button>
            </div>
        </div>
    `;

        document.body.insertAdjacentHTML('beforeend', toastHtml);
        const toastElement = document.querySelector('.toast:last-child');
        const toast = new bootstrap.Toast(toastElement, { delay: 3000 });
        toast.show();

        setTimeout(() => toastElement.remove(), 3500);
    }

</script>
</body>
</html>



