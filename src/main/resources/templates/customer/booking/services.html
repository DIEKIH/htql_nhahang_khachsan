<!--<!DOCTYPE html>-->
<!--<html lang="vi" xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Xác nhận đặt phòng - Bước 2</title>-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">-->
<!--    <style>-->
<!--        :root {-->
<!--            &#45;&#45;primary-color: #c9a96e;-->
<!--            &#45;&#45;secondary-color: #2c3e50;-->
<!--        }-->

<!--        body {-->
<!--            background: #f8f9fa;-->
<!--            padding-top: 80px;-->
<!--            font-size: 0.95rem; /* Giảm 5% */-->
<!--        }-->

<!--        /* Container max-width để không bị rộng quá */-->
<!--        .container {-->
<!--            max-width: 1320px; /* Giới hạn chiều rộng */-->
<!--        }-->

<!--        /* Booking Steps - Thu nhỏ */-->
<!--        .booking-steps {-->
<!--            background: white;-->
<!--            padding: 20px 25px; /* Giảm padding */-->
<!--            margin-bottom: 25px;-->
<!--            border-radius: 12px;-->
<!--            box-shadow: 0 4px 12px rgba(0,0,0,0.06);-->
<!--        }-->

<!--        .step {-->
<!--            display: flex;-->
<!--            flex-direction: column;-->
<!--            align-items: center;-->
<!--            position: relative;-->
<!--        }-->

<!--        .step-number {-->
<!--            width: 42px; /* Giảm từ 50px */-->
<!--            height: 42px;-->
<!--            border-radius: 50%;-->
<!--            background: #e9ecef;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            justify-content: center;-->
<!--            font-weight: 600;-->
<!--            font-size: 0.95rem;-->
<!--            margin-bottom: 8px;-->
<!--        }-->

<!--        .step.active .step-number {-->
<!--            background: var(&#45;&#45;primary-color);-->
<!--            color: white;-->
<!--        }-->

<!--        .step.completed .step-number {-->
<!--            background: #28a745;-->
<!--            color: white;-->
<!--        }-->

<!--        .step-title {-->
<!--            font-size: 0.85rem; /* Giảm kích thước text */-->
<!--            text-align: center;-->
<!--        }-->

<!--        /* Booking Card - Compact hơn */-->
<!--        .booking-card {-->
<!--            background: white;-->
<!--            border-radius: 12px;-->
<!--            padding: 22px 25px; /* Giảm padding */-->
<!--            box-shadow: 0 4px 12px rgba(0,0,0,0.06);-->
<!--            margin-bottom: 18px;-->
<!--        }-->

<!--        .booking-card h4 {-->
<!--            font-size: 1.15rem; /* Giảm heading */-->
<!--            margin-bottom: 15px;-->
<!--        }-->

<!--        .booking-card h5 {-->
<!--            font-size: 1.05rem;-->
<!--            margin-bottom: 12px;-->
<!--        }-->

<!--        .booking-card p {-->
<!--            font-size: 0.9rem;-->
<!--            margin-bottom: 8px;-->
<!--            line-height: 1.5;-->
<!--        }-->

<!--        /* Service Item - Compact */-->
<!--        .service-item {-->
<!--            border: 2px solid #e9ecef;-->
<!--            border-radius: 10px;-->
<!--            padding: 16px 18px; /* Giảm padding */-->
<!--            margin-bottom: 12px;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s;-->
<!--        }-->

<!--        .service-item:hover {-->
<!--            border-color: var(&#45;&#45;primary-color);-->
<!--            transform: translateY(-2px);-->
<!--        }-->

<!--        .service-item.selected {-->
<!--            border-color: var(&#45;&#45;primary-color);-->
<!--            background: rgba(201, 169, 110, 0.05);-->
<!--        }-->

<!--        .service-item h6 {-->
<!--            font-size: 0.95rem;-->
<!--            margin-bottom: 4px;-->
<!--        }-->

<!--        .service-item small {-->
<!--            font-size: 0.8rem;-->
<!--        }-->

<!--        /* Price Row - Compact */-->
<!--        .price-row {-->
<!--            display: flex;-->
<!--            justify-content: space-between;-->
<!--            padding: 8px 0; /* Giảm padding */-->
<!--            font-size: 0.9rem;-->
<!--        }-->

<!--        .price-row.total {-->
<!--            font-size: 1.1rem; /* Giảm từ 1.2rem */-->
<!--            font-weight: bold;-->
<!--            color: var(&#45;&#45;primary-color);-->
<!--            border-top: 2px solid #e9ecef;-->
<!--            padding-top: 12px;-->
<!--            margin-top: 8px;-->
<!--        }-->

<!--        /* Buttons - Compact */-->
<!--        .btn-luxury {-->
<!--            background: var(&#45;&#45;primary-color);-->
<!--            color: white;-->
<!--            padding: 10px 24px; /* Giảm padding */-->
<!--            border: none;-->
<!--            border-radius: 50px;-->
<!--            font-weight: 600;-->
<!--            font-size: 0.95rem;-->
<!--        }-->

<!--        .btn-luxury:hover {-->
<!--            background: #b8956b;-->
<!--            color: white;-->
<!--            transform: translateY(-2px);-->
<!--            box-shadow: 0 4px 12px rgba(201, 169, 110, 0.3);-->
<!--        }-->

<!--        /* Sticky Sidebar - Điều chỉnh top */-->
<!--        .sticky-sidebar {-->
<!--            position: sticky;-->
<!--            top: 90px; /* Giảm từ 100px */-->
<!--        }-->

<!--        /* Alert - Compact */-->
<!--        .alert {-->
<!--            padding: 10px 14px;-->
<!--            font-size: 0.85rem;-->
<!--            margin-bottom: 12px;-->
<!--        }-->

<!--        /* Responsive adjustments */-->
<!--        @media (max-width: 1400px) {-->
<!--            .container {-->
<!--                max-width: 1140px;-->
<!--            }-->
<!--        }-->

<!--        @media (max-width: 1200px) {-->
<!--            body {-->
<!--                font-size: 0.9rem;-->
<!--            }-->

<!--            .booking-card {-->
<!--                padding: 18px 20px;-->
<!--            }-->

<!--            .service-item {-->
<!--                padding: 14px 16px;-->
<!--            }-->
<!--        }-->

<!--        @media (max-width: 992px) {-->
<!--            .sticky-sidebar {-->
<!--                position: static;-->
<!--                margin-top: 20px;-->
<!--            }-->
<!--        }-->

<!--        @media (max-width: 768px) {-->
<!--            body {-->
<!--                padding-top: 70px;-->
<!--            }-->

<!--            .booking-steps {-->
<!--                padding: 15px;-->
<!--            }-->

<!--            .step-number {-->
<!--                width: 38px;-->
<!--                height: 38px;-->
<!--                font-size: 0.9rem;-->
<!--            }-->

<!--            .step-title {-->
<!--                font-size: 0.75rem;-->
<!--            }-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<div th:replace="fragments/user_navbar :: user_navbar"></div>-->

<!--<div class="container my-4">-->
<!--    &lt;!&ndash; Booking Steps &ndash;&gt;-->
<!--    <div class="booking-steps">-->
<!--        <div class="row">-->
<!--            <div class="col-md-3 col-6">-->
<!--                <div class="step completed">-->
<!--                    <div class="step-number">1</div>-->
<!--                    <div class="step-title">Chọn phòng</div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3 col-6">-->
<!--                <div class="step active">-->
<!--                    <div class="step-number">2</div>-->
<!--                    <div class="step-title">Dịch vụ</div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3 col-6">-->
<!--                <div class="step">-->
<!--                    <div class="step-number">3</div>-->
<!--                    <div class="step-title">Thông tin</div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3 col-6">-->
<!--                <div class="step">-->
<!--                    <div class="step-number">4</div>-->
<!--                    <div class="step-title">Thanh toán</div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    <div class="row">-->
<!--        <div class="col-lg-8">-->
<!--            &lt;!&ndash; Thông tin đặt phòng &ndash;&gt;-->
<!--            <div class="booking-card">-->
<!--                <h4><i class="fas fa-bed me-2"></i>Thông tin đặt phòng</h4>-->
<!--                <hr>-->
<!--                <div class="row">-->
<!--                    <div class="col-md-6">-->
<!--                        <p><strong>Loại phòng:</strong> <span th:text="${bookingSession.roomType != null ? bookingSession.roomType.name : 'N/A'}">Deluxe</span></p>-->
<!--                        <p><strong>Chi nhánh:</strong> <span th:text="${bookingSession.roomType != null ? bookingSession.roomType.branchName : 'N/A'}">Hà Nội</span></p>-->
<!--                        <p><strong>Số phòng:</strong> <span th:text="${bookingSession.numberOfRooms}">1</span> phòng</p>-->
<!--                    </div>-->
<!--                    <div class="col-md-6">-->
<!--                        <p><strong>Nhận phòng:</strong> <span th:text="${#temporals.format(bookingSession.checkInDate, 'dd/MM/yyyy')}">15/12/2024</span></p>-->
<!--                        <p><strong>Trả phòng:</strong> <span th:text="${#temporals.format(bookingSession.checkOutDate, 'dd/MM/yyyy')}">18/12/2024</span></p>-->
<!--                        <p><strong>Số đêm:</strong> <span th:text="${bookingSession.numberOfNights}">3</span> đêm</p>-->
<!--                        <p><strong>Khách:</strong> <span th:text="${bookingSession.adults}">2</span> người lớn-->
<!--                            <span th:if="${bookingSession.children > 0}" th:text="', ' + ${bookingSession.children} + ' trẻ em'"></span>-->
<!--                        </p>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Dịch vụ bổ sung &ndash;&gt;-->
<!--            <div class="booking-card">-->
<!--                <h4><i class="fas fa-concierge-bell me-2"></i>Dịch vụ bổ sung</h4>-->
<!--                <hr>-->

<!--                <div class="service-item" id="breakfastService" onclick="toggleService('breakfast')">-->
<!--                    <div class="form-check">-->
<!--                        <input class="form-check-input" type="checkbox" id="includeBreakfast"-->
<!--                               th:checked="${session.includeBreakfast}">-->
<!--                        <label class="form-check-label w-100" for="includeBreakfast">-->
<!--                            <div class="d-flex justify-content-between align-items-center">-->
<!--                                <div>-->
<!--                                    <h6 class="mb-1"><i class="fas fa-coffee me-2"></i>Buffet sáng</h6>-->
<!--                                    <small class="text-muted">Buffet sáng cao cấp (200.000đ/người/ngày)</small>-->
<!--                                </div>-->
<!--                                <div class="text-end">-->
<!--                                    <strong class="text-primary" id="breakfastPrice"-->
<!--                                            th:text="${#numbers.formatDecimal(bookingSession.breakfastFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </label>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div class="service-item" id="spaService" onclick="toggleService('spa')">-->
<!--                    <div class="form-check">-->
<!--                        <input class="form-check-input" type="checkbox" id="includeSpa"-->
<!--                               th:checked="${bookingSession.includeSpa}">-->
<!--                        <label class="form-check-label w-100" for="includeSpa">-->
<!--                            <div class="d-flex justify-content-between align-items-center">-->
<!--                                <div>-->
<!--                                    <h6 class="mb-1"><i class="fas fa-spa me-2"></i>Spa Package</h6>-->
<!--                                    <small class="text-muted">Gói massage & spa 90 phút (500.000đ/người)</small>-->
<!--                                </div>-->
<!--                                <div class="text-end">-->
<!--                                    <strong class="text-primary" id="spaPrice"-->
<!--                                            th:text="${#numbers.formatDecimal(bookingSession.spaFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </label>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div class="service-item" id="airportService" onclick="toggleService('airport')">-->
<!--                    <div class="form-check">-->
<!--                        <input class="form-check-input" type="checkbox" id="includeAirportTransfer"-->
<!--                               th:checked="${bookingSession.includeAirportTransfer}">-->
<!--                        <label class="form-check-label w-100" for="includeAirportTransfer">-->
<!--                            <div class="d-flex justify-content-between align-items-center">-->
<!--                                <div>-->
<!--                                    <h6 class="mb-1"><i class="fas fa-car me-2"></i>Đưa đón sân bay</h6>-->
<!--                                    <small class="text-muted">Dịch vụ xe riêng đưa đón (300.000đ)</small>-->
<!--                                </div>-->
<!--                                <div class="text-end">-->
<!--                                    <strong class="text-primary" id="airportPrice"-->
<!--                                            th:text="${#numbers.formatDecimal(bookingSession.airportTransferFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </label>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; Sidebar - Tóm tắt giá &ndash;&gt;-->
<!--        <div class="col-lg-4">-->
<!--            <div class="booking-card sticky-sidebar">-->
<!--                <h5><i class="fas fa-receipt me-2"></i>Chi tiết giá</h5>-->
<!--                <hr>-->

<!--                <div class="price-row">-->
<!--                    <span>Giá phòng (<span th:text="${bookingSession.numberOfNights}">3</span> đêm)</span>-->
<!--                    <span id="displayRoomPrice" th:text="${#numbers.formatDecimal(bookingSession.totalRoomPrice, 0, 'COMMA', 0, 'POINT') + 'đ'}">5,400,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row" id="displayBreakfast"-->
<!--                     th:style="${bookingSession.includeBreakfast != null and bookingSession.includeBreakfast ? '' : 'display: none;'}">-->
<!--                    <span>Buffet sáng</span>-->
<!--                    <span th:text="${#numbers.formatDecimal(bookingSession.breakfastFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">1,200,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row" id="displaySpa"-->
<!--                     th:style="${bookingSession.includeSpa != null and bookingSession.includeSpa ? '' : 'display: none;'}">-->
<!--                    <span>Spa package</span>-->
<!--                    <span th:text="${#numbers.formatDecimal(bookingSession.spaFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">1,000,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row" id="displayAirport"-->
<!--                     th:style="${bookingSession.includeAirportTransfer != null and bookingSession.includeAirportTransfer ? '' : 'display: none;'}">-->
<!--                    <span>Đưa đón sân bay</span>-->
<!--                    <span th:text="${#numbers.formatDecimal(bookingSession.airportTransferFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">300,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row">-->
<!--                    <span>Phí dịch vụ (10%)</span>-->
<!--                    <span id="displayServiceFee" th:text="${#numbers.formatDecimal(bookingSession.serviceFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">540,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row">-->
<!--                    <span>VAT (10%)</span>-->
<!--                    <span id="displayVat" th:text="${#numbers.formatDecimal(bookingSession.vat, 0, 'COMMA', 0, 'POINT') + 'đ'}">594,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row total">-->
<!--                    <span>Tổng cộng</span>-->
<!--                    <span id="displayTotal" th:text="${#numbers.formatDecimal(bookingSession.totalAmount, 0, 'COMMA', 0, 'POINT') + 'đ'}">6,534,000đ</span>-->
<!--                </div>-->

<!--                <div class="alert alert-info mt-2">-->
<!--                    <small>-->
<!--                        <i class="fas fa-info-circle me-1"></i>-->
<!--                        Có thể thanh toán 50% (<span id="displayDeposit" th:text="${#numbers.formatDecimal(bookingSession.depositAmount, 0, 'COMMA', 0, 'POINT') + 'đ'}">3,267,000đ</span>) để đặt cọc-->
<!--                    </small>-->
<!--                </div>-->

<!--                <div class="d-grid gap-2">-->
<!--                    <button type="button" class="btn btn-luxury" onclick="continueToGuestInfo()">-->
<!--                        <i class="fas fa-arrow-right me-2"></i>Tiếp tục-->
<!--                    </button>-->
<!--                    <a th:href="@{/room-types/{id}(id=${bookingSession.roomTypeId})}" class="btn btn-outline-secondary btn-sm">-->
<!--                        <i class="fas fa-arrow-left me-2"></i>Quay lại-->
<!--                    </a>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>-->
<!--<script th:inline="javascript">-->
<!--    const sessionId = /*[[${bookingSession.sessionId}]]*/ "";-->

<!--    function continueToGuestInfo() {-->
<!--        const includeBreakfast = document.getElementById('includeBreakfast').checked;-->
<!--        const includeSpa = document.getElementById('includeSpa').checked;-->
<!--        const includeAirportTransfer = document.getElementById('includeAirportTransfer').checked;-->

<!--        const continueBtn = event.target;-->
<!--        continueBtn.disabled = true;-->
<!--        continueBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Đang xử lý...';-->

<!--        fetch(`/bookings/update-services/${sessionId}`, {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json',-->
<!--            },-->
<!--            body: JSON.stringify({-->
<!--                includeBreakfast: includeBreakfast,-->
<!--                includeSpa: includeSpa,-->
<!--                includeAirportTransfer: includeAirportTransfer-->
<!--            })-->
<!--        })-->
<!--            .then(response => {-->
<!--                if (!response.ok) {-->
<!--                    throw new Error('Network response was not ok');-->
<!--                }-->
<!--                return response.json();-->
<!--            })-->
<!--            .then(data => {-->
<!--                window.location.href = `/bookings/guest-info/${sessionId}`;-->
<!--            })-->
<!--            .catch(error => {-->
<!--                console.error('Error:', error);-->
<!--                alert('Có lỗi xảy ra. Vui lòng thử lại!');-->
<!--                continueBtn.disabled = false;-->
<!--                continueBtn.innerHTML = '<i class="fas fa-arrow-right me-2"></i>Tiếp tục';-->
<!--            });-->
<!--    }-->

<!--    function toggleService(serviceType) {-->
<!--        const checkbox = document.getElementById('include' + serviceType.charAt(0).toUpperCase() + serviceType.slice(1));-->
<!--        checkbox.checked = !checkbox.checked;-->

<!--        const serviceItem = document.getElementById(serviceType + 'Service');-->
<!--        if (checkbox.checked) {-->
<!--            serviceItem.classList.add('selected');-->
<!--        } else {-->
<!--            serviceItem.classList.remove('selected');-->
<!--        }-->

<!--        updatePrice();-->
<!--    }-->

<!--    function updatePrice() {-->
<!--        const includeBreakfast = document.getElementById('includeBreakfast').checked;-->
<!--        const includeSpa = document.getElementById('includeSpa').checked;-->
<!--        const includeAirportTransfer = document.getElementById('includeAirportTransfer').checked;-->

<!--        fetch(`/bookings/calculate-price/${sessionId}?` + new URLSearchParams({-->
<!--            includeBreakfast: includeBreakfast,-->
<!--            includeSpa: includeSpa,-->
<!--            includeAirportTransfer: includeAirportTransfer-->
<!--        }))-->
<!--            .then(response => response.json())-->
<!--            .then(data => {-->
<!--                document.getElementById('displayServiceFee').textContent = formatCurrency(data.serviceFee);-->
<!--                document.getElementById('displayVat').textContent = formatCurrency(data.vat);-->
<!--                document.getElementById('displayTotal').textContent = formatCurrency(data.totalAmount);-->
<!--                document.getElementById('displayDeposit').textContent = formatCurrency(data.depositAmount);-->

<!--                document.getElementById('displayBreakfast').style.display = includeBreakfast ? 'flex' : 'none';-->
<!--                document.getElementById('displaySpa').style.display = includeSpa ? 'flex' : 'none';-->
<!--                document.getElementById('displayAirport').style.display = includeAirportTransfer ? 'flex' : 'none';-->

<!--                if (includeBreakfast) {-->
<!--                    document.querySelector('#displayBreakfast span:last-child').textContent = formatCurrency(data.breakfastFee);-->
<!--                }-->
<!--                if (includeSpa) {-->
<!--                    document.querySelector('#displaySpa span:last-child').textContent = formatCurrency(data.spaFee);-->
<!--                }-->
<!--                if (includeAirportTransfer) {-->
<!--                    document.querySelector('#displayAirport span:last-child').textContent = formatCurrency(data.airportTransferFee);-->
<!--                }-->
<!--            })-->
<!--            .catch(error => console.error('Error:', error));-->
<!--    }-->

<!--    function formatCurrency(amount) {-->
<!--        return new Intl.NumberFormat('vi-VN').format(amount) + 'đ';-->
<!--    }-->

<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        if (document.getElementById('includeBreakfast').checked) {-->
<!--            document.getElementById('breakfastService').classList.add('selected');-->
<!--        }-->
<!--        if (document.getElementById('includeSpa').checked) {-->
<!--            document.getElementById('spaService').classList.add('selected');-->
<!--        }-->
<!--        if (document.getElementById('includeAirportTransfer').checked) {-->
<!--            document.getElementById('airportService').classList.add('selected');-->
<!--        }-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->
<!--<!DOCTYPE html>-->
<!--<html lang="vi" xmlns:th="http://www.thymeleaf.org">-->
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <title>Xác nhận đặt phòng - Bước 2</title>-->
<!--    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">-->
<!--    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">-->
<!--    <link rel="stylesheet" th:href="@{/css/user_navbar.css}">-->

<!--    <style>-->



<!--        :root {-->
<!--            &#45;&#45;primary-color: #c9a96e;-->
<!--            &#45;&#45;secondary-color: #2c3e50;-->
<!--            &#45;&#45;accent-color: #f8f9fa;-->
<!--            &#45;&#45;text-dark: #2c3e50;-->
<!--            &#45;&#45;text-light: #6c757d;-->
<!--            &#45;&#45;bg-overlay: rgba(44, 62, 80, 0.7);-->
<!--            &#45;&#45;scale: 0.75;-->
<!--        }-->


<!--        * {-->
<!--            box-sizing: border-box;-->
<!--        }-->

<!--        html {-->
<!--            font-size: calc(16px * var(&#45;&#45;scale));-->
<!--        }-->

<!--        body {-->
<!--            font-family: 'Inter', sans-serif;-->
<!--            line-height: 1.6;-->
<!--            color: var(&#45;&#45;text-dark);-->
<!--            padding-top: calc(80px * var(&#45;&#45;scale));-->
<!--        }-->

<!--        .heading-font {-->
<!--            font-family: 'Playfair Display', serif;-->
<!--        }-->

<!--        /* Navigation */-->
<!--        .navbar {-->
<!--            background: rgba(255, 255, 255, 0.98) !important;-->
<!--            backdrop-filter: blur(10px);-->
<!--            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);-->
<!--            height: calc(80px * var(&#45;&#45;scale));-->
<!--        }-->

<!--        .navbar-brand {-->
<!--            font-family: 'Playfair Display', serif;-->
<!--            font-size: calc(2rem * var(&#45;&#45;scale));-->
<!--            font-weight: 600;-->
<!--            color: var(&#45;&#45;primary-color) !important;-->
<!--        }-->

<!--        .navbar-nav .nav-link {-->
<!--            font-weight: 500;-->
<!--            margin: 0 calc(10px * var(&#45;&#45;scale));-->
<!--            color: var(&#45;&#45;text-dark) !important;-->
<!--            transition: all 0.3s ease;-->
<!--        }-->

<!--        .navbar-nav .nav-link:hover,-->
<!--        .navbar-nav .nav-link.active {-->
<!--            color: var(&#45;&#45;primary-color) !important;-->
<!--        }-->

<!--        .btn-luxury {-->
<!--            background: var(&#45;&#45;primary-color);-->
<!--            color: white;-->
<!--            padding: calc(12px * var(&#45;&#45;scale)) calc(30px * var(&#45;&#45;scale));-->
<!--            border: none;-->
<!--            font-weight: 600;-->
<!--            text-transform: uppercase;-->
<!--            letter-spacing: 1px;-->
<!--            transition: all 0.3s ease;-->
<!--            border-radius: calc(50px * var(&#45;&#45;scale));-->
<!--        }-->

<!--        .btn-luxury:hover {-->
<!--            background: #b8956b;-->
<!--            transform: translateY(calc(-3px * var(&#45;&#45;scale)));-->
<!--            box-shadow: 0 10px 25px rgba(201, 169, 110, 0.4);-->
<!--            color: white;-->
<!--        }-->



<!--        /*.container {*/-->
<!--        /*    max-width: 990px; !* 1320px * 0.75 *!*/-->
<!--        /*    padding-left: 11.25px; !* 15px * 0.75 *!*/-->
<!--        /*    padding-right: 11.25px;*/-->
<!--        /*}*/-->

<!--        /* Booking Steps */-->
<!--        .booking-steps {-->
<!--            background: white;-->
<!--            padding: 22.5px;-->
<!--            margin-bottom: 22.5px;-->
<!--            border-radius: 11.25px;-->
<!--            box-shadow: 0 3.75px 11.25px rgba(0,0,0,0.06);-->
<!--        }-->

<!--        .booking-steps .row {-->
<!--            margin-left: -7.5px;-->
<!--            margin-right: -7.5px;-->
<!--        }-->

<!--        .booking-steps [class*="col-"] {-->
<!--            padding-left: 7.5px;-->
<!--            padding-right: 7.5px;-->
<!--        }-->

<!--        .step {-->
<!--            display: flex;-->
<!--            flex-direction: column;-->
<!--            align-items: center;-->
<!--            position: relative;-->
<!--        }-->

<!--        .step-number {-->
<!--            width: 37.5px; /* 42px * 0.75 */-->
<!--            height: 37.5px;-->
<!--            border-radius: 50%;-->
<!--            background: #e9ecef;-->
<!--            display: flex;-->
<!--            align-items: center;-->
<!--            justify-content: center;-->
<!--            font-weight: 600;-->
<!--            font-size: 11px;-->
<!--            margin-bottom: 6px;-->
<!--        }-->

<!--        .step.active .step-number {-->
<!--            background: var(&#45;&#45;primary-color);-->
<!--            color: white;-->
<!--        }-->

<!--        .step.completed .step-number {-->
<!--            background: #28a745;-->
<!--            color: white;-->
<!--        }-->

<!--        .step-title {-->
<!--            font-size: 10.5px;-->
<!--            text-align: center;-->
<!--        }-->

<!--        /* Main row */-->
<!--        .main-row {-->
<!--            margin-left: -7.5px;-->
<!--            margin-right: -7.5px;-->
<!--        }-->

<!--        .main-row > [class*="col-"] {-->
<!--            padding-left: 7.5px;-->
<!--            padding-right: 7.5px;-->
<!--        }-->

<!--        /* Booking Card */-->
<!--        .booking-card {-->
<!--            background: white;-->
<!--            border-radius: 9px;-->
<!--            padding: 16px 18px;-->
<!--            box-shadow: 0 3px 9px rgba(0,0,0,0.05);-->
<!--            margin-bottom: 13.5px;-->
<!--        }-->

<!--        .booking-card h4 {-->
<!--            font-size: 14px;-->
<!--            margin-bottom: 11px;-->
<!--            font-weight: 600;-->
<!--        }-->

<!--        .booking-card h5 {-->
<!--            font-size: 13px;-->
<!--            margin-bottom: 9px;-->
<!--            font-weight: 600;-->
<!--        }-->

<!--        .booking-card hr {-->
<!--            margin: 9px 0;-->
<!--            opacity: 0.1;-->
<!--        }-->

<!--        .booking-card p {-->
<!--            font-size: 11px;-->
<!--            margin-bottom: 6px;-->
<!--            line-height: 1.4;-->
<!--        }-->

<!--        .booking-card .row {-->
<!--            margin-left: -7.5px;-->
<!--            margin-right: -7.5px;-->
<!--        }-->

<!--        .booking-card [class*="col-"] {-->
<!--            padding-left: 7.5px;-->
<!--            padding-right: 7.5px;-->
<!--        }-->

<!--        /* Service Item */-->
<!--        .service-item {-->
<!--            border: 1.5px solid #e9ecef;-->
<!--            border-radius: 7.5px;-->
<!--            padding: 12px 13.5px;-->
<!--            margin-bottom: 9px;-->
<!--            cursor: pointer;-->
<!--            transition: all 0.3s;-->
<!--        }-->

<!--        .service-item:hover {-->
<!--            border-color: var(&#45;&#45;primary-color);-->
<!--            transform: translateY(-1.5px);-->
<!--        }-->

<!--        .service-item.selected {-->
<!--            border-color: var(&#45;&#45;primary-color);-->
<!--            background: rgba(201, 169, 110, 0.05);-->
<!--        }-->

<!--        .service-item .form-check {-->
<!--            margin-bottom: 0;-->
<!--            padding-left: 22.5px;-->
<!--        }-->

<!--        .service-item .form-check-input {-->
<!--            width: 15px;-->
<!--            height: 15px;-->
<!--            margin-top: 1.5px;-->
<!--            margin-left: -22.5px;-->
<!--        }-->

<!--        .service-item h6 {-->
<!--            font-size: 11.5px;-->
<!--            margin-bottom: 3px;-->
<!--            font-weight: 600;-->
<!--        }-->

<!--        .service-item small {-->
<!--            font-size: 10px;-->
<!--        }-->

<!--        /* Price Row */-->
<!--        .price-row {-->
<!--            display: flex;-->
<!--            justify-content: space-between;-->
<!--            padding: 6px 0;-->
<!--            font-size: 11px;-->
<!--        }-->

<!--        .price-row.total {-->
<!--            font-size: 13px;-->
<!--            font-weight: bold;-->
<!--            color: var(&#45;&#45;primary-color);-->
<!--            border-top: 1.5px solid #e9ecef;-->
<!--            padding-top: 9px;-->
<!--            margin-top: 6px;-->
<!--        }-->

<!--        /* Buttons */-->
<!--        .btn-luxury {-->
<!--            background: var(&#45;&#45;primary-color);-->
<!--            color: white;-->
<!--            padding: 8px 18px;-->
<!--            border: none;-->
<!--            border-radius: 37.5px;-->
<!--            font-weight: 600;-->
<!--            font-size: 11.5px;-->
<!--            transition: all 0.3s;-->
<!--        }-->

<!--        .btn-luxury:hover {-->
<!--            background: #b8956b;-->
<!--            color: white;-->
<!--            transform: translateY(-1.5px);-->
<!--            box-shadow: 0 3px 9px rgba(201, 169, 110, 0.3);-->
<!--        }-->

<!--        .btn-outline-secondary {-->
<!--            padding: 6px 15px;-->
<!--            font-size: 10.5px;-->
<!--            border-radius: 37.5px;-->
<!--        }-->

<!--        /* Sticky Sidebar */-->
<!--        .sticky-sidebar {-->
<!--            position: sticky;-->
<!--            top: 67.5px;-->
<!--        }-->

<!--        /* Alert */-->
<!--        .alert {-->
<!--            padding: 7.5px 10.5px;-->
<!--            font-size: 10px;-->
<!--            margin-bottom: 9px;-->
<!--            margin-top: 7.5px;-->
<!--            border-radius: 6px;-->
<!--        }-->

<!--        /* Grid gap */-->
<!--        .d-grid.gap-2 {-->
<!--            gap: 7.5px !important;-->
<!--        }-->

<!--        /* Icons */-->
<!--        .fa, .fas {-->
<!--            font-size: 11px;-->
<!--        }-->

<!--        .me-1 {-->
<!--            margin-right: 3px !important;-->
<!--        }-->

<!--        .me-2 {-->
<!--            margin-right: 6px !important;-->
<!--        }-->

<!--        .my-5 {-->
<!--            margin-top: 15px !important;-->
<!--            margin-bottom: 15px !important;-->
<!--        }-->

<!--        /* Text utilities */-->
<!--        .text-muted {-->
<!--            color: #6c757d !important;-->
<!--        }-->

<!--        .text-primary {-->
<!--            color: var(&#45;&#45;primary-color) !important;-->
<!--        }-->

<!--        .text-end {-->
<!--            text-align: right;-->
<!--        }-->

<!--        /* Responsive */-->
<!--        @media (max-width: 1400px) {-->
<!--            .container {-->
<!--                max-width: 855px; /* 1140px * 0.75 */-->
<!--            }-->
<!--        }-->

<!--        @media (max-width: 1200px) {-->
<!--            body {-->
<!--                font-size: 11px;-->
<!--            }-->

<!--            .booking-card {-->
<!--                padding: 13.5px 15px;-->
<!--            }-->

<!--            .service-item {-->
<!--                padding: 10.5px 12px;-->
<!--            }-->
<!--        }-->

<!--        @media (max-width: 992px) {-->
<!--            .sticky-sidebar {-->
<!--                position: static;-->
<!--                margin-top: 15px;-->
<!--            }-->

<!--            .container {-->
<!--                max-width: 540px; /* 720px * 0.75 */-->
<!--            }-->
<!--        }-->

<!--        @media (max-width: 768px) {-->
<!--            body {-->
<!--                padding-top: 52.5px;-->
<!--                font-size: 10px;-->
<!--            }-->

<!--            .container {-->
<!--                max-width: 405px; /* 540px * 0.75 */-->
<!--            }-->
<!--            :root {-->
<!--                &#45;&#45;scale: 0.65;-->
<!--            }-->

<!--            .booking-steps {-->
<!--                padding: 15px;-->
<!--            }-->

<!--            .step-number {-->
<!--                width: 28.5px;-->
<!--                height: 28.5px;-->
<!--                font-size: 10px;-->
<!--            }-->

<!--            .step-title {-->
<!--                font-size: 9px;-->
<!--            }-->
<!--        }-->

<!--        @media (max-width: 576px) {-->
<!--            .container {-->
<!--                max-width: 100%;-->
<!--            }-->
<!--        }-->
<!--    </style>-->
<!--</head>-->
<!--<body>-->
<!--<div th:replace="fragments/user_navbar :: user_navbar"></div>-->
<!--<nav th:fragment="user_navbar" class="navbar navbar-expand-lg fixed-top">-->
<!--    <div class="container">-->
<!--        <a class="navbar-brand" th:href="@{/}"><i class="fas fa-crown me-2"></i>DIEK</a>-->
<!--        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">-->
<!--            <span class="navbar-toggler-icon"></span>-->
<!--        </button>-->
<!--        <div class="collapse navbar-collapse" id="navbarNav">-->
<!--            <ul class="navbar-nav ms-auto" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">-->
<!--                <li class="nav-item"><a class="nav-link" th:href="@{/}">Trang chủ</a></li>-->
<!--                <li class="nav-item"><a class="nav-link" th:href="@{/#branches}">Chi nhánh</a></li>-->
<!--                <li class="nav-item"><a class="nav-link" href="#facilities">Tiện ích</a></li>-->
<!--                <li class="nav-item"><a class="nav-link" href="#contact">Liên hệ</a></li>-->

<!--                <li class="nav-item" sec:authorize="isAnonymous()">-->
<!--                    <a class="nav-link btn btn-outline-primary ms-2" th:href="@{/customer/login}">-->
<!--                        <i class="fas fa-sign-in-alt me-2"></i>Đăng nhập-->
<!--                    </a>-->
<!--                </li>-->

<!--                <li class="nav-item dropdown" sec:authorize="isAuthenticated()">-->
<!--                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">-->
<!--                        <i class="fas fa-user-circle me-1"></i>-->
<!--                        <span sec:authentication="name">Username</span>-->
<!--                    </a>-->
<!--                    <ul class="dropdown-menu dropdown-menu-end">-->
<!--                        <li>-->
<!--                            <a class="dropdown-item" th:href="@{/cart}">-->
<!--                                <i class="fas fa-shopping-cart fa-fw me-2"></i>Giỏ hàng-->
<!--                                <span class="badge bg-danger rounded-pill" th:if="${session.cartItemCount > 0}" th:text="${session.cartItemCount}">0</span>-->
<!--                            </a>-->
<!--                        </li>-->
<!--                        <li><a class="dropdown-item" th:href="@{/orders}"><i class="fas fa-receipt fa-fw me-2"></i>Xem đơn hàng</a></li>-->
<!--                        <li><hr class="dropdown-divider"></li>-->
<!--                        <li>-->
<!--                            <form th:action="@{/logout}" method="post" class="d-inline">-->
<!--                                <button type="submit" class="dropdown-item">-->
<!--                                    <i class="fas fa-sign-out-alt fa-fw me-2"></i>Đăng xuất-->
<!--                                </button>-->
<!--                            </form>-->
<!--                        </li>-->
<!--                    </ul>-->
<!--                </li>-->
<!--            </ul>-->
<!--        </div>-->
<!--    </div>-->
<!--</nav>-->
<!--<div class="container my-5">-->
<!--    &lt;!&ndash; Booking Steps &ndash;&gt;-->
<!--    <div class="booking-steps">-->
<!--        <div class="row">-->
<!--            <div class="col-md-3">-->
<!--                <div class="step completed">-->
<!--                    <div class="step-number"><i class="fas fa-check"></i></div>-->
<!--                    <div class="step-title">Chọn phòng</div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3 ">-->
<!--                <div class="step active">-->
<!--                    <div class="step-number">2</div>-->
<!--                    <div class="step-title">Dịch vụ</div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3 ">-->
<!--                <div class="step">-->
<!--                    <div class="step-number">3</div>-->
<!--                    <div class="step-title">Thông tin</div>-->
<!--                </div>-->
<!--            </div>-->
<!--            <div class="col-md-3 ">-->
<!--                <div class="step">-->
<!--                    <div class="step-number">4</div>-->
<!--                    <div class="step-title">Thanh toán</div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->

<!--    <div class="row main-row">-->
<!--        <div class="col-lg-8">-->
<!--            &lt;!&ndash; Thông tin đặt phòng &ndash;&gt;-->
<!--            <div class="booking-card">-->
<!--                <h4><i class="fas fa-bed me-2"></i>Thông tin đặt phòng</h4>-->
<!--                <hr>-->
<!--                <div class="row">-->
<!--                    <div class="col-md-6">-->
<!--                        <p><strong>Loại phòng:</strong> <span th:text="${bookingSession.roomType != null ? bookingSession.roomType.name : 'N/A'}">Deluxe</span></p>-->
<!--                        <p><strong>Chi nhánh:</strong> <span th:text="${bookingSession.roomType != null ? bookingSession.roomType.branchName : 'N/A'}">Hà Nội</span></p>-->
<!--                        <p><strong>Số phòng:</strong> <span th:text="${bookingSession.numberOfRooms}">1</span> phòng</p>-->
<!--                    </div>-->
<!--                    <div class="col-md-6">-->
<!--                        <p><strong>Nhận phòng:</strong> <span th:text="${#temporals.format(bookingSession.checkInDate, 'dd/MM/yyyy')}">15/12/2024</span></p>-->
<!--                        <p><strong>Trả phòng:</strong> <span th:text="${#temporals.format(bookingSession.checkOutDate, 'dd/MM/yyyy')}">18/12/2024</span></p>-->
<!--                        <p><strong>Số đêm:</strong> <span th:text="${bookingSession.numberOfNights}">3</span> đêm</p>-->
<!--                        <p><strong>Khách:</strong> <span th:text="${bookingSession.adults}">2</span> người lớn-->
<!--                            <span th:if="${bookingSession.children > 0}" th:text="', ' + ${bookingSession.children} + ' trẻ em'"></span>-->
<!--                        </p>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->

<!--            &lt;!&ndash; Dịch vụ bổ sung &ndash;&gt;-->
<!--            <div class="booking-card">-->
<!--                <h4><i class="fas fa-concierge-bell me-2"></i>Dịch vụ bổ sung</h4>-->
<!--                <hr>-->

<!--                <div class="service-item" id="breakfastService" onclick="toggleService('breakfast')">-->
<!--                    <div class="form-check">-->
<!--                        <input class="form-check-input" type="checkbox" id="includeBreakfast"-->
<!--                               th:checked="${session.includeBreakfast}">-->
<!--                        <label class="form-check-label w-100" for="includeBreakfast">-->
<!--                            <div class="d-flex justify-content-between align-items-center">-->
<!--                                <div>-->
<!--                                    <h6 class="mb-1"><i class="fas fa-coffee me-2"></i>Buffet sáng</h6>-->
<!--                                    <small class="text-muted">Buffet sáng cao cấp (200.000đ/người/ngày)</small>-->
<!--                                </div>-->
<!--                                <div class="text-end">-->
<!--                                    <strong class="text-primary" id="breakfastPrice"-->
<!--                                            th:text="${#numbers.formatDecimal(bookingSession.breakfastFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </label>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div class="service-item" id="spaService" onclick="toggleService('spa')">-->
<!--                    <div class="form-check">-->
<!--                        <input class="form-check-input" type="checkbox" id="includeSpa"-->
<!--                               th:checked="${bookingSession.includeSpa}">-->
<!--                        <label class="form-check-label w-100" for="includeSpa">-->
<!--                            <div class="d-flex justify-content-between align-items-center">-->
<!--                                <div>-->
<!--                                    <h6 class="mb-1"><i class="fas fa-spa me-2"></i>Spa Package</h6>-->
<!--                                    <small class="text-muted">Gói massage & spa 90 phút (500.000đ/người)</small>-->
<!--                                </div>-->
<!--                                <div class="text-end">-->
<!--                                    <strong class="text-primary" id="spaPrice"-->
<!--                                            th:text="${#numbers.formatDecimal(bookingSession.spaFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </label>-->
<!--                    </div>-->
<!--                </div>-->

<!--                <div class="service-item" id="airportService" onclick="toggleService('airport')">-->
<!--                    <div class="form-check">-->
<!--                        <input class="form-check-input" type="checkbox" id="includeAirportTransfer"-->
<!--                               th:checked="${bookingSession.includeAirportTransfer}">-->
<!--                        <label class="form-check-label w-100" for="includeAirportTransfer">-->
<!--                            <div class="d-flex justify-content-between align-items-center">-->
<!--                                <div>-->
<!--                                    <h6 class="mb-1"><i class="fas fa-car me-2"></i>Đưa đón sân bay</h6>-->
<!--                                    <small class="text-muted">Dịch vụ xe riêng đưa đón (300.000đ)</small>-->
<!--                                </div>-->
<!--                                <div class="text-end">-->
<!--                                    <strong class="text-primary" id="airportPrice"-->
<!--                                            th:text="${#numbers.formatDecimal(bookingSession.airportTransferFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </label>-->
<!--                    </div>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->

<!--        &lt;!&ndash; Sidebar - Tóm tắt giá &ndash;&gt;-->
<!--        <div class="col-lg-4">-->
<!--            <div class="booking-card sticky-sidebar">-->
<!--                <h5><i class="fas fa-receipt me-2"></i>Chi tiết giá</h5>-->
<!--                <hr>-->

<!--                <div class="price-row">-->
<!--                    <span>Giá phòng (<span th:text="${bookingSession.numberOfNights}">3</span> đêm)</span>-->
<!--                    <span id="displayRoomPrice" th:text="${#numbers.formatDecimal(bookingSession.totalRoomPrice, 0, 'COMMA', 0, 'POINT') + 'đ'}">5,400,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row" id="displayBreakfast"-->
<!--                     th:style="${bookingSession.includeBreakfast != null and bookingSession.includeBreakfast ? '' : 'display: none;'}">-->
<!--                    <span>Buffet sáng</span>-->
<!--                    <span th:text="${#numbers.formatDecimal(bookingSession.breakfastFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">1,200,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row" id="displaySpa"-->
<!--                     th:style="${bookingSession.includeSpa != null and bookingSession.includeSpa ? '' : 'display: none;'}">-->
<!--                    <span>Spa package</span>-->
<!--                    <span th:text="${#numbers.formatDecimal(bookingSession.spaFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">1,000,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row" id="displayAirport"-->
<!--                     th:style="${bookingSession.includeAirportTransfer != null and bookingSession.includeAirportTransfer ? '' : 'display: none;'}">-->
<!--                    <span>Đưa đón sân bay</span>-->
<!--                    <span th:text="${#numbers.formatDecimal(bookingSession.airportTransferFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">300,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row">-->
<!--                    <span>Phí dịch vụ (10%)</span>-->
<!--                    <span id="displayServiceFee" th:text="${#numbers.formatDecimal(bookingSession.serviceFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">540,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row">-->
<!--                    <span>VAT (10%)</span>-->
<!--                    <span id="displayVat" th:text="${#numbers.formatDecimal(bookingSession.vat, 0, 'COMMA', 0, 'POINT') + 'đ'}">594,000đ</span>-->
<!--                </div>-->

<!--                <div class="price-row total">-->
<!--                    <span>Tổng cộng</span>-->
<!--                    <span id="displayTotal" th:text="${#numbers.formatDecimal(bookingSession.totalAmount, 0, 'COMMA', 0, 'POINT') + 'đ'}">6,534,000đ</span>-->
<!--                </div>-->

<!--                <div class="alert alert-info">-->
<!--                    <small>-->
<!--                        <i class="fas fa-info-circle me-1"></i>-->
<!--                        Có thể thanh toán 50% (<span id="displayDeposit" th:text="${#numbers.formatDecimal(bookingSession.depositAmount, 0, 'COMMA', 0, 'POINT') + 'đ'}">3,267,000đ</span>) để đặt cọc-->
<!--                    </small>-->
<!--                </div>-->

<!--                <div class="d-grid gap-2">-->
<!--                    <button type="button" class="btn btn-luxury" onclick="continueToGuestInfo()">-->
<!--                        <i class="fas fa-arrow-right me-2"></i>Tiếp tục-->
<!--                    </button>-->
<!--                    <a th:href="@{/room-types/{id}(id=${bookingSession.roomTypeId})}" class="btn btn-outline-secondary btn-sm">-->
<!--                        <i class="fas fa-arrow-left me-2"></i>Quay lại-->
<!--                    </a>-->
<!--                </div>-->
<!--            </div>-->
<!--        </div>-->
<!--    </div>-->
<!--</div>-->

<!--<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>-->
<!--<script th:inline="javascript">-->
<!--    const sessionId = /*[[${bookingSession.sessionId}]]*/ "";-->

<!--    function continueToGuestInfo() {-->
<!--        const includeBreakfast = document.getElementById('includeBreakfast').checked;-->
<!--        const includeSpa = document.getElementById('includeSpa').checked;-->
<!--        const includeAirportTransfer = document.getElementById('includeAirportTransfer').checked;-->

<!--        const continueBtn = event.target;-->
<!--        continueBtn.disabled = true;-->
<!--        continueBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Đang xử lý...';-->

<!--        fetch(`/bookings/update-services/${sessionId}`, {-->
<!--            method: 'POST',-->
<!--            headers: {-->
<!--                'Content-Type': 'application/json',-->
<!--            },-->
<!--            body: JSON.stringify({-->
<!--                includeBreakfast: includeBreakfast,-->
<!--                includeSpa: includeSpa,-->
<!--                includeAirportTransfer: includeAirportTransfer-->
<!--            })-->
<!--        })-->
<!--            .then(response => {-->
<!--                if (!response.ok) {-->
<!--                    throw new Error('Network response was not ok');-->
<!--                }-->
<!--                return response.json();-->
<!--            })-->
<!--            .then(data => {-->
<!--                window.location.href = `/bookings/guest-info/${sessionId}`;-->
<!--            })-->
<!--            .catch(error => {-->
<!--                console.error('Error:', error);-->
<!--                alert('Có lỗi xảy ra. Vui lòng thử lại!');-->
<!--                continueBtn.disabled = false;-->
<!--                continueBtn.innerHTML = '<i class="fas fa-arrow-right me-2"></i>Tiếp tục';-->
<!--            });-->
<!--    }-->

<!--    function toggleService(serviceType) {-->
<!--        const checkbox = document.getElementById('include' + serviceType.charAt(0).toUpperCase() + serviceType.slice(1));-->
<!--        checkbox.checked = !checkbox.checked;-->

<!--        const serviceItem = document.getElementById(serviceType + 'Service');-->
<!--        if (checkbox.checked) {-->
<!--            serviceItem.classList.add('selected');-->
<!--        } else {-->
<!--            serviceItem.classList.remove('selected');-->
<!--        }-->

<!--        updatePrice();-->
<!--    }-->

<!--    function updatePrice() {-->
<!--        const includeBreakfast = document.getElementById('includeBreakfast').checked;-->
<!--        const includeSpa = document.getElementById('includeSpa').checked;-->
<!--        const includeAirportTransfer = document.getElementById('includeAirportTransfer').checked;-->

<!--        fetch(`/bookings/calculate-price/${sessionId}?` + new URLSearchParams({-->
<!--            includeBreakfast: includeBreakfast,-->
<!--            includeSpa: includeSpa,-->
<!--            includeAirportTransfer: includeAirportTransfer-->
<!--        }))-->
<!--            .then(response => response.json())-->
<!--            .then(data => {-->
<!--                document.getElementById('displayServiceFee').textContent = formatCurrency(data.serviceFee);-->
<!--                document.getElementById('displayVat').textContent = formatCurrency(data.vat);-->
<!--                document.getElementById('displayTotal').textContent = formatCurrency(data.totalAmount);-->
<!--                document.getElementById('displayDeposit').textContent = formatCurrency(data.depositAmount);-->

<!--                document.getElementById('displayBreakfast').style.display = includeBreakfast ? 'flex' : 'none';-->
<!--                document.getElementById('displaySpa').style.display = includeSpa ? 'flex' : 'none';-->
<!--                document.getElementById('displayAirport').style.display = includeAirportTransfer ? 'flex' : 'none';-->

<!--                if (includeBreakfast) {-->
<!--                    document.querySelector('#displayBreakfast span:last-child').textContent = formatCurrency(data.breakfastFee);-->
<!--                }-->
<!--                if (includeSpa) {-->
<!--                    document.querySelector('#displaySpa span:last-child').textContent = formatCurrency(data.spaFee);-->
<!--                }-->
<!--                if (includeAirportTransfer) {-->
<!--                    document.querySelector('#displayAirport span:last-child').textContent = formatCurrency(data.airportTransferFee);-->
<!--                }-->
<!--            })-->
<!--            .catch(error => console.error('Error:', error));-->
<!--    }-->

<!--    function formatCurrency(amount) {-->
<!--        return new Intl.NumberFormat('vi-VN').format(amount) + 'đ';-->
<!--    }-->

<!--    document.addEventListener('DOMContentLoaded', function() {-->
<!--        if (document.getElementById('includeBreakfast').checked) {-->
<!--            document.getElementById('breakfastService').classList.add('selected');-->
<!--        }-->
<!--        if (document.getElementById('includeSpa').checked) {-->
<!--            document.getElementById('spaService').classList.add('selected');-->
<!--        }-->
<!--        if (document.getElementById('includeAirportTransfer').checked) {-->
<!--            document.getElementById('airportService').classList.add('selected');-->
<!--        }-->
<!--    });-->
<!--</script>-->
<!--</body>-->
<!--</html>-->
<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Xác nhận đặt phòng - Bước 2</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Font Awesome -->
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">

    <!-- Google Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@300;400;500;600;700&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <!-- ⚠️ NAVBAR CSS - IMPORT TRƯỚC internal styles -->
    <link rel="stylesheet" th:href="@{/css/user_navbar.css}">
    <style>
        :root {
            --primary-color: #c9a96e;
            --secondary-color: #2c3e50;
            --accent-color: #f8f9fa;
            --text-dark: #2c3e50;
            --text-light: #6c757d;
            --bg-overlay: rgba(44, 62, 80, 0.7);
            --scale: 0.75;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html {
            font-size: calc(16px * var(--scale));
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.6;
            color: var(--text-dark);
            padding-top: calc(80px * var(--scale));
        }

        .heading-font {
            font-family: 'Playfair Display', serif;
        }

        /* Navigation */
        .navbar {
            background: rgba(255, 255, 255, 0.98) !important;
            backdrop-filter: blur(10px);
            box-shadow: 0 2px 20px rgba(0, 0, 0, 0.1);
            height: calc(80px * var(--scale));
        }

        .navbar-brand {
            font-family: 'Playfair Display', serif;
            font-size: calc(2rem * var(--scale));
            font-weight: 600;
            color: var(--primary-color) !important;
        }

        .navbar-nav .nav-link {
            font-weight: 500;
            margin: 0 calc(10px * var(--scale));
            color: var(--text-dark) !important;
            transition: all 0.3s ease;
        }

        .navbar-nav .nav-link:hover,
        .navbar-nav .nav-link.active {
            color: var(--primary-color) !important;
        }

        .btn-luxury {
            background: var(--primary-color);
            color: white;
            padding: calc(12px * var(--scale)) calc(30px * var(--scale));
            border: none;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 1px;
            transition: all 0.3s ease;
            border-radius: calc(50px * var(--scale));
        }

        .btn-luxury:hover {
            background: #b8956b;
            transform: translateY(calc(-3px * var(--scale)));
            box-shadow: 0 10px 25px rgba(201, 169, 110, 0.4);
            color: white;
        }


        /* Booking Steps */
        .booking-steps {
            background: white;
            padding: 22.5px;
            margin-bottom: 22.5px;
            border-radius: 11.25px;
            box-shadow: 0 3.75px 11.25px rgba(0,0,0,0.06);
        }

        .booking-steps .row {
            margin-left: -7.5px;
            margin-right: -7.5px;
        }

        .booking-steps [class*="col-"] {
            padding-left: 7.5px;
            padding-right: 7.5px;
        }

        .step {
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }

        .step-number {
            width: 37.5px;
            height: 37.5px;
            border-radius: 50%;
            background: #e9ecef;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 600;
            font-size: 11px;
            margin-bottom: 6px;
        }

        .step.active .step-number {
            background: var(--primary-color);
            color: white;
        }

        .step.completed .step-number {
            background: #28a745;
            color: white;
        }

        .step-title {
            font-size: 10.5px;
            text-align: center;
        }

        /* Main row */
        .main-row {
            margin-left: -7.5px;
            margin-right: -7.5px;
        }

        .main-row > [class*="col-"] {
            padding-left: 7.5px;
            padding-right: 7.5px;
        }

        /* Booking Card */
        .booking-card {
            background: white;
            border-radius: 9px;
            padding: 16px 18px;
            box-shadow: 0 3px 9px rgba(0,0,0,0.05);
            margin-bottom: 13.5px;
        }

        .booking-card h4 {
            font-size: 14px;
            margin-bottom: 11px;
            font-weight: 600;
        }

        .booking-card h5 {
            font-size: 13px;
            margin-bottom: 9px;
            font-weight: 600;
        }

        .booking-card hr {
            margin: 9px 0;
            opacity: 0.1;
        }

        .booking-card p {
            font-size: 11px;
            margin-bottom: 6px;
            line-height: 1.4;
        }

        .booking-card .row {
            margin-left: -7.5px;
            margin-right: -7.5px;
        }

        .booking-card [class*="col-"] {
            padding-left: 7.5px;
            padding-right: 7.5px;
        }

        /* Service Item */
        .service-item {
            border: 1.5px solid #e9ecef;
            border-radius: 7.5px;
            padding: 12px 13.5px;
            margin-bottom: 9px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .service-item:hover {
            border-color: var(--primary-color);
            transform: translateY(-1.5px);
        }

        .service-item.selected {
            border-color: var(--primary-color);
            background: rgba(201, 169, 110, 0.05);
        }

        .service-item .form-check {
            margin-bottom: 0;
            padding-left: 22.5px;
        }

        .service-item .form-check-input {
            width: 15px;
            height: 15px;
            margin-top: 1.5px;
            margin-left: -22.5px;
        }

        .service-item h6 {
            font-size: 11.5px;
            margin-bottom: 3px;
            font-weight: 600;
        }

        .service-item small {
            font-size: 10px;
        }

        /* Price Row */
        .price-row {
            display: flex;
            justify-content: space-between;
            padding: 6px 0;
            font-size: 11px;
        }

        .price-row.total {
            font-size: 13px;
            font-weight: bold;
            color: var(--primary-color);
            border-top: 1.5px solid #e9ecef;
            padding-top: 9px;
            margin-top: 6px;
        }

        /* Buttons */
        .btn-luxury {
            background: var(--primary-color);
            color: white;
            padding: 8px 18px;
            border: none;
            border-radius: 37.5px;
            font-weight: 600;
            font-size: 11.5px;
            transition: all 0.3s;
        }

        .btn-luxury:hover {
            background: #b8956b;
            color: white;
            transform: translateY(-1.5px);
            box-shadow: 0 3px 9px rgba(201, 169, 110, 0.3);
        }

        .btn-outline-secondary {
            padding: 6px 15px;
            font-size: 10.5px;
            border-radius: 37.5px;
        }

        /* Sticky Sidebar */
        .sticky-sidebar {
            position: sticky;
            top: 67.5px;
        }

        /* Alert */
        .alert {
            padding: 7.5px 10.5px;
            font-size: 10px;
            margin-bottom: 9px;
            margin-top: 7.5px;
            border-radius: 6px;
        }

        /* Grid gap */
        .d-grid.gap-2 {
            gap: 7.5px !important;
        }


        .me-1 {
            margin-right: 3px !important;
        }

        .me-2 {
            margin-right: 6px !important;
        }

        .my-5 {
            margin-top: 15px !important;
            margin-bottom: 15px !important;
        }

        /* Text utilities */
        .text-muted {
            color: #6c757d !important;
        }

        .text-primary {
            color: var(--primary-color) !important;
        }

        .text-end {
            text-align: right;
        }

        /* Responsive */
        @media (max-width: 1400px) {
            .container {
                max-width: 855px;
            }
        }

        @media (max-width: 1200px) {
            body {
                font-size: 11px;
            }

            .booking-card {
                padding: 13.5px 15px;
            }

            .service-item {
                padding: 10.5px 12px;
            }
        }

        @media (max-width: 992px) {
            .sticky-sidebar {
                position: static;
                margin-top: 15px;
            }

            .container {
                max-width: 540px;
            }
        }

        @media (max-width: 768px) {
            body {
                padding-top: 52.5px;
                font-size: 10px;
            }

            .container {
                max-width: 405px;
            }

            :root {
                --scale: 0.65;
            }

            .booking-steps {
                padding: 15px;
            }

            .step-number {
                width: 28.5px;
                height: 28.5px;
                font-size: 10px;
            }

            .step-title {
                font-size: 9px;
            }
        }

        @media (max-width: 576px) {
            .container {
                max-width: 100%;
            }
        }
    </style>
</head>
<body>

<!-- Navigation - Sử dụng fragment từ user_navbar.html -->
<!--<div th:replace="fragments/user_navbar :: user_navbar"></div>-->

<nav th:fragment="user_navbar" class="navbar navbar-expand-lg fixed-top">
    <div class="container">
        <a class="navbar-brand" th:href="@{/}"><i class="fas fa-crown me-2"></i>DIEK</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarNav">
            <ul class="navbar-nav ms-auto" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">
                <li class="nav-item"><a class="nav-link" th:href="@{/}">Trang chủ</a></li>
                <li class="nav-item"><a class="nav-link" th:href="@{/#branches}">Chi nhánh</a></li>
                <li class="nav-item"><a class="nav-link" href="#facilities">Tiện ích</a></li>
                <li class="nav-item"><a class="nav-link" href="#contact">Liên hệ</a></li>

                <li class="nav-item" sec:authorize="isAnonymous()">
                    <a class="nav-link btn btn-outline-primary ms-2" th:href="@{/customer/login}">
                        <i class="fas fa-sign-in-alt me-2"></i>Đăng nhập
                    </a>
                </li>

                <li class="nav-item dropdown" sec:authorize="isAuthenticated()">
                    <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-bs-toggle="dropdown">
                        <i class="fas fa-user-circle me-1"></i>
                        <span sec:authentication="name">Username</span>
                    </a>
                    <ul class="dropdown-menu dropdown-menu-end">
                        <li>
                            <a class="dropdown-item" th:href="@{/cart}">
                                <i class="fas fa-shopping-cart fa-fw me-2"></i>Giỏ hàng
                                <span class="badge bg-danger rounded-pill" th:if="${session.cartItemCount > 0}" th:text="${session.cartItemCount}">0</span>
                            </a>
                        </li>
                        <li><a class="dropdown-item" th:href="@{/orders}"><i class="fas fa-receipt fa-fw me-2"></i>Xem đơn hàng</a></li>
                        <li><hr class="dropdown-divider"></li>
                        <li>
                            <form th:action="@{/logout}" method="post" class="d-inline">
                                <button type="submit" class="dropdown-item">
                                    <i class="fas fa-sign-out-alt fa-fw me-2"></i>Đăng xuất
                                </button>
                            </form>
                        </li>
                    </ul>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container my-5">
    <!-- Booking Steps -->
    <div class="booking-steps">
        <div class="row">
            <div class="col-md-3">
                <div class="step completed">
                    <div class="step-number"><i class="fas fa-check"></i></div>
                    <div class="step-title">Chọn phòng</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="step active">
                    <div class="step-number">2</div>
                    <div class="step-title">Dịch vụ</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="step">
                    <div class="step-number">3</div>
                    <div class="step-title">Thông tin</div>
                </div>
            </div>
            <div class="col-md-3">
                <div class="step">
                    <div class="step-number">4</div>
                    <div class="step-title">Thanh toán</div>
                </div>
            </div>
        </div>
    </div>

    <div class="row main-row">
        <div class="col-lg-8">
            <!-- Thông tin đặt phòng -->
            <div class="booking-card">
                <h4><i class="fas fa-bed me-2"></i>Thông tin đặt phòng</h4>
                <hr>
                <div class="row">
                    <div class="col-md-6">
                        <p><strong>Loại phòng:</strong> <span th:text="${bookingSession.roomType != null ? bookingSession.roomType.name : 'N/A'}">Deluxe</span></p>
                        <p><strong>Chi nhánh:</strong> <span th:text="${bookingSession.roomType != null ? bookingSession.roomType.branchName : 'N/A'}">Hà Nội</span></p>
                        <p><strong>Số phòng:</strong> <span th:text="${bookingSession.numberOfRooms}">1</span> phòng</p>
                    </div>
                    <div class="col-md-6">
                        <p><strong>Nhận phòng:</strong> <span th:text="${#temporals.format(bookingSession.checkInDate, 'dd/MM/yyyy')}">15/12/2024</span></p>
                        <p><strong>Trả phòng:</strong> <span th:text="${#temporals.format(bookingSession.checkOutDate, 'dd/MM/yyyy')}">18/12/2024</span></p>
                        <p><strong>Số đêm:</strong> <span th:text="${bookingSession.numberOfNights}">3</span> đêm</p>
                        <p><strong>Khách:</strong> <span th:text="${bookingSession.adults}">2</span> người lớn
                            <span th:if="${bookingSession.children > 0}" th:text="', ' + ${bookingSession.children} + ' trẻ em'"></span>
                        </p>
                    </div>
                </div>
            </div>

            <!-- Dịch vụ bổ sung -->
            <div class="booking-card">
                <h4><i class="fas fa-concierge-bell me-2"></i>Dịch vụ bổ sung</h4>
                <hr>

                <div class="service-item" id="breakfastService" onclick="toggleService('breakfast')">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="includeBreakfast"
                               th:checked="${session.includeBreakfast}">
                        <label class="form-check-label w-100" for="includeBreakfast">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-1"><i class="fas fa-coffee me-2"></i>Buffet sáng</h6>
                                    <small class="text-muted">Buffet sáng cao cấp (200.000đ/người/ngày)</small>
                                </div>
                                <div class="text-end">
                                    <strong class="text-primary" id="breakfastPrice"
                                            th:text="${#numbers.formatDecimal(bookingSession.breakfastFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="service-item" id="spaService" onclick="toggleService('spa')">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="includeSpa"
                               th:checked="${bookingSession.includeSpa}">
                        <label class="form-check-label w-100" for="includeSpa">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-1"><i class="fas fa-spa me-2"></i>Spa Package</h6>
                                    <small class="text-muted">Gói massage & spa 90 phút (500.000đ/người)</small>
                                </div>
                                <div class="text-end">
                                    <strong class="text-primary" id="spaPrice"
                                            th:text="${#numbers.formatDecimal(bookingSession.spaFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>

                <div class="service-item" id="airportService" onclick="toggleService('airport')">
                    <div class="form-check">
                        <input class="form-check-input" type="checkbox" id="includeAirportTransfer"
                               th:checked="${bookingSession.includeAirportTransfer}">
                        <label class="form-check-label w-100" for="includeAirportTransfer">
                            <div class="d-flex justify-content-between align-items-center">
                                <div>
                                    <h6 class="mb-1"><i class="fas fa-car me-2"></i>Đưa đón sân bay</h6>
                                    <small class="text-muted">Dịch vụ xe riêng đưa đón (300.000đ)</small>
                                </div>
                                <div class="text-end">
                                    <strong class="text-primary" id="airportPrice"
                                            th:text="${#numbers.formatDecimal(bookingSession.airportTransferFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">0đ</strong>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sidebar - Tóm tắt giá -->
        <div class="col-lg-4">
            <div class="booking-card sticky-sidebar">
                <h5><i class="fas fa-receipt me-2"></i>Chi tiết giá</h5>
                <hr>

                <div class="price-row">
                    <span>Giá phòng (<span th:text="${bookingSession.numberOfNights}">3</span> đêm)</span>
                    <span id="displayRoomPrice" th:text="${#numbers.formatDecimal(bookingSession.totalRoomPrice, 0, 'COMMA', 0, 'POINT') + 'đ'}">5,400,000đ</span>
                </div>

                <div class="price-row" id="displayBreakfast"
                     th:style="${bookingSession.includeBreakfast != null and bookingSession.includeBreakfast ? '' : 'display: none;'}">
                    <span>Buffet sáng</span>
                    <span th:text="${#numbers.formatDecimal(bookingSession.breakfastFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">1,200,000đ</span>
                </div>

                <div class="price-row" id="displaySpa"
                     th:style="${bookingSession.includeSpa != null and bookingSession.includeSpa ? '' : 'display: none;'}">
                    <span>Spa package</span>
                    <span th:text="${#numbers.formatDecimal(bookingSession.spaFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">1,000,000đ</span>
                </div>

                <div class="price-row" id="displayAirport"
                     th:style="${bookingSession.includeAirportTransfer != null and bookingSession.includeAirportTransfer ? '' : 'display: none;'}">
                    <span>Đưa đón sân bay</span>
                    <span th:text="${#numbers.formatDecimal(bookingSession.airportTransferFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">300,000đ</span>
                </div>

                <div class="price-row">
                    <span>Phí dịch vụ (10%)</span>
                    <span id="displayServiceFee" th:text="${#numbers.formatDecimal(bookingSession.serviceFee, 0, 'COMMA', 0, 'POINT') + 'đ'}">540,000đ</span>
                </div>

                <div class="price-row">
                    <span>VAT (10%)</span>
                    <span id="displayVat" th:text="${#numbers.formatDecimal(bookingSession.vat, 0, 'COMMA', 0, 'POINT') + 'đ'}">594,000đ</span>
                </div>

                <div class="price-row total">
                    <span>Tổng cộng</span>
                    <span id="displayTotal" th:text="${#numbers.formatDecimal(bookingSession.totalAmount, 0, 'COMMA', 0, 'POINT') + 'đ'}">6,534,000đ</span>
                </div>

                <div class="alert alert-info">
                    <small>
                        <i class="fas fa-info-circle me-1"></i>
                        Có thể thanh toán 50% (<span id="displayDeposit" th:text="${#numbers.formatDecimal(bookingSession.depositAmount, 0, 'COMMA', 0, 'POINT') + 'đ'}">3,267,000đ</span>) để đặt cọc
                    </small>
                </div>

                <div class="d-grid gap-2">
                    <button type="button" class="btn btn-luxury" onclick="continueToGuestInfo()">
                        <i class="fas fa-arrow-right me-2"></i>Tiếp tục
                    </button>
                    <a th:href="@{/room-types/{id}(id=${bookingSession.roomTypeId})}" class="btn btn-outline-secondary btn-sm">
                        <i class="fas fa-arrow-left me-2"></i>Quay lại
                    </a>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script th:inline="javascript">
    const sessionId = /*[[${bookingSession.sessionId}]]*/ "";

    function continueToGuestInfo() {
        const includeBreakfast = document.getElementById('includeBreakfast').checked;
        const includeSpa = document.getElementById('includeSpa').checked;
        const includeAirportTransfer = document.getElementById('includeAirportTransfer').checked;

        const continueBtn = event.target;
        continueBtn.disabled = true;
        continueBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-2"></i>Đang xử lý...';

        fetch(`/bookings/update-services/${sessionId}`, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify({
                includeBreakfast: includeBreakfast,
                includeSpa: includeSpa,
                includeAirportTransfer: includeAirportTransfer
            })
        })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                window.location.href = `/bookings/guest-info/${sessionId}`;
            })
            .catch(error => {
                console.error('Error:', error);
                alert('Có lỗi xảy ra. Vui lòng thử lại!');
                continueBtn.disabled = false;
                continueBtn.innerHTML = '<i class="fas fa-arrow-right me-2"></i>Tiếp tục';
            });
    }

    function toggleService(serviceType) {
        const checkbox = document.getElementById('include' + serviceType.charAt(0).toUpperCase() + serviceType.slice(1));
        checkbox.checked = !checkbox.checked;

        const serviceItem = document.getElementById(serviceType + 'Service');
        if (checkbox.checked) {
            serviceItem.classList.add('selected');
        } else {
            serviceItem.classList.remove('selected');
        }

        updatePrice();
    }

    function updatePrice() {
        const includeBreakfast = document.getElementById('includeBreakfast').checked;
        const includeSpa = document.getElementById('includeSpa').checked;
        const includeAirportTransfer = document.getElementById('includeAirportTransfer').checked;

        fetch(`/bookings/calculate-price/${sessionId}?` + new URLSearchParams({
            includeBreakfast: includeBreakfast,
            includeSpa: includeSpa,
            includeAirportTransfer: includeAirportTransfer
        }))
            .then(response => response.json())
            .then(data => {
                document.getElementById('displayServiceFee').textContent = formatCurrency(data.serviceFee);
                document.getElementById('displayVat').textContent = formatCurrency(data.vat);
                document.getElementById('displayTotal').textContent = formatCurrency(data.totalAmount);
                document.getElementById('displayDeposit').textContent = formatCurrency(data.depositAmount);

                document.getElementById('displayBreakfast').style.display = includeBreakfast ? 'flex' : 'none';
                document.getElementById('displaySpa').style.display = includeSpa ? 'flex' : 'none';
                document.getElementById('displayAirport').style.display = includeAirportTransfer ? 'flex' : 'none';

                if (includeBreakfast) {
                    document.querySelector('#displayBreakfast span:last-child').textContent = formatCurrency(data.breakfastFee);
                }
                if (includeSpa) {
                    document.querySelector('#displaySpa span:last-child').textContent = formatCurrency(data.spaFee);
                }
                if (includeAirportTransfer) {
                    document.querySelector('#displayAirport span:last-child').textContent = formatCurrency(data.airportTransferFee);
                }
            })
            .catch(error => console.error('Error:', error));
    }

    function formatCurrency(amount) {
        return new Intl.NumberFormat('vi-VN').format(amount) + 'đ';
    }

    document.addEventListener('DOMContentLoaded', function() {
        if (document.getElementById('includeBreakfast').checked) {
            document.getElementById('breakfastService').classList.add('selected');
        }
        if (document.getElementById('includeSpa').checked) {
            document.getElementById('spaService').classList.add('selected');
        }
        if (document.getElementById('includeAirportTransfer').checked) {
            document.getElementById('airportService').classList.add('selected');
        }
    });
</script>
</body>
</html>